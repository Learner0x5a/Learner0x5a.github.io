<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Learner0x5a&#39;s Studio</title>
  
  
  <link href="https://learner0x5a.github.io/atom.xml" rel="self"/>
  
  <link href="https://learner0x5a.github.io/"/>
  <updated>2021-11-04T03:27:14.761Z</updated>
  <id>https://learner0x5a.github.io/</id>
  
  <author>
    <name>Learner0x5a</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Huggingface笔记</title>
    <link href="https://learner0x5a.github.io/2021/11/03/huggingface/"/>
    <id>https://learner0x5a.github.io/2021/11/03/huggingface/</id>
    <published>2021-11-03T06:26:01.000Z</published>
    <updated>2021-11-04T03:27:14.761Z</updated>
    
    <content type="html"><![CDATA[<h1 id="需求1-自定义tokenizer"><a href="#需求1-自定义tokenizer" class="headerlink" title="需求1: 自定义tokenizer"></a>需求1: 自定义tokenizer</h1><p><a href="https://huggingface.co/docs/tokenizers/python/latest/pipeline.html">官方文档</a>给出了很好的说明。 <br>但都是要训练的tokenizer，如果想要实现一个完全自定义的，<br>需要参考<a href="https://github.com/huggingface/tokenizers/blob/b24a2fc1781d5da4e6ebcd3ecb5b91edffc0a05f/bindings/python/examples/custom_components.py">这里</a>。</p><p>如果无法魔改，那么可以先用自己的方法分完词，用分好词之后的预料训练一个huggingface的WhiteSpace pretokenizer。</p><h1 id="需求2-自定义mask"><a href="#需求2-自定义mask" class="headerlink" title="需求2: 自定义mask"></a>需求2: 自定义mask</h1><p>需要修改<a href="https://huggingface.co/transformers/main_classes/data_collator.html">DataCollatorForLanguageModeling</a>类 <br><a href="https://huggingface.co/transformers/_modules/transformers/data/data_collator.html#DataCollatorForLanguageModeling">源码</a><br>的torch_mask_tokens方法，官方代码利用伯努利分布随机采样得到mask:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">probability_matrix.masked_fill_(special_tokens_mask, value=<span class="number">0.0</span>)</span><br><span class="line">masked_indices = torch.bernoulli(probability_matrix).<span class="built_in">bool</span>()</span><br><span class="line">labels[~masked_indices] = -<span class="number">100</span>  <span class="comment"># We only compute loss on masked tokens; ~表示按位取反</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 80% of the time, we replace masked input tokens with tokenizer.mask_token ([MASK])</span></span><br><span class="line">indices_replaced = torch.bernoulli(torch.full(labels.shape, <span class="number">0.8</span>)).<span class="built_in">bool</span>() &amp; masked_indices</span><br><span class="line">inputs[indices_replaced] = self.tokenizer.convert_tokens_to_ids(self.tokenizer.mask_token)</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>注：huggingface的attention mask是用来处理多序列的padding的情况。<br>参考：<br><a href="https://cloud.tencent.com/developer/article/1885829">https://cloud.tencent.com/developer/article/1885829</a><br><a href="https://huggingface.co/transformers/glossary.html">https://huggingface.co/transformers/glossary.html</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;需求1-自定义tokenizer&quot;&gt;&lt;a href=&quot;#需求1-自定义tokenizer&quot; class=&quot;headerlink&quot; title=&quot;需求1: 自定义tokenizer&quot;&gt;&lt;/a&gt;需求1: 自定义tokenizer&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;htt</summary>
      
    
    
    
    
    <category term="Tools" scheme="https://learner0x5a.github.io/tags/Tools/"/>
    
    <category term="AI" scheme="https://learner0x5a.github.io/tags/AI/"/>
    
  </entry>
  
  <entry>
    <title>二进制代码相似性文献调研</title>
    <link href="https://learner0x5a.github.io/2021/10/21/BinSim/"/>
    <id>https://learner0x5a.github.io/2021/10/21/BinSim/</id>
    <published>2021-10-21T07:07:40.000Z</published>
    <updated>2021-10-21T10:37:00.940Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://kdocs.cn/l/csc2bETWuhN1">https://kdocs.cn/l/csc2bETWuhN1</a><br>[金山文档] binsim-survey.xlsx</p><p>TBD</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://kdocs.cn/l/csc2bETWuhN1&quot;&gt;https://kdocs.cn/l/csc2bETWuhN1&lt;/a&gt;&lt;br&gt;[金山文档] binsim-survey.xlsx&lt;/p&gt;
&lt;p&gt;TBD&lt;/p&gt;
</summary>
      
    
    
    
    
    <category term="PaperReading" scheme="https://learner0x5a.github.io/tags/PaperReading/"/>
    
  </entry>
  
  <entry>
    <title>ElasticSearch (OpenSearch)</title>
    <link href="https://learner0x5a.github.io/2021/10/20/ElasticSearch/"/>
    <id>https://learner0x5a.github.io/2021/10/20/ElasticSearch/</id>
    <published>2021-10-20T01:50:45.000Z</published>
    <updated>2021-10-20T06:48:14.205Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ElasticSearch"><a href="#ElasticSearch" class="headerlink" title="ElasticSearch"></a>ElasticSearch</h1><p>Elasticsearch 是一个开源的搜索引擎，建立在全文搜索引擎库 Apache Lucene™ 基础之上。 Lucene 是当下最先进、高性能、全功能的搜索引擎库。 <br>Elasticsearch 使用 Java 编写，其内部使用 Lucene 做索引与搜索，但是隐藏了 Lucene 的复杂性，取而代之的一套简单一致的 RESTful API。</p><p>存储数据到 Elasticsearch 的行为叫做 索引 ，但在索引一个文档之前，需要确定将文档存储在哪里。 \</p><p>一个 Elasticsearch 实例可以 包含多个 索引 ，相应的每个索引可以包含多个 类型 。 这些不同的类型存储着多个 文档 ，每个文档又有 多个 属性 。</p><p>ES中的index就像sql中的库，type就像sql中的表，document就像sql中的记录。 <br>但事实上，ElasticSearch实现上“真正用于分隔数据的结构“只有index，而没有type，type实际上作为了一个元数据（类似SQL中的id，作为额外的标识数据）来实现逻辑划分。</p><p>TODO: 看一遍文档</p><h2 id="集群"><a href="#集群" class="headerlink" title="集群"></a>集群</h2><p>目前开发环境只用单节点。</p><p>TBD</p><h1 id="OpenSearch"><a href="#OpenSearch" class="headerlink" title="OpenSearch"></a>OpenSearch</h1><p>基于Elasticsearch 7.10.2 &amp; Kibana 7.10.2集成了一堆插件，尤其是近似KNN搜索插件。</p><h2 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h2><p>使用 OpenSearch REST API 为数据编制索引。存在两种 API：索引 API 和_bulkAPI。 \</p><p>对于新数据以增量方式到达的情况（例如，来自小型企业的客户订单），可以使用 索引 API 在文档到达时单独添加文档。\</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PUT &lt;index&gt;&#x2F;_doc&#x2F;&lt;id&gt;</span><br><span class="line">&#123; &quot;A JSON&quot;: &quot;document&quot; &#125;</span><br></pre></td></tr></table></figure><p>例如</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -H &#39;Content-Type: application&#x2F;json&#39; -XPUT &quot;https:&#x2F;&#x2F;localhost:9200&#x2F;movies&#x2F;_doc&#x2F;1&quot; -d &#39;&#123; &quot;title&quot;: &quot;Spirited Away&quot; &#125;&#39; -u &#39;admin:admin&#39; --insecure</span><br></pre></td></tr></table></figure><p><em>注意<code>-d</code>后面要用单引号，json内部要用双引号</em></p><p>对于数据流不太频繁的情况（例如，营销网站的每周更新），可以生成一个文件并将其发送到_bulkAPI。\</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">POST _bulk</span><br><span class="line">&#123; &quot;index&quot;: &#123; &quot;_index&quot;: &quot;&lt;index&gt;&quot;, &quot;_id&quot;: &quot;&lt;id&gt;&quot; &#125; &#125;</span><br><span class="line">&#123; &quot;A JSON&quot;: &quot;document&quot; &#125;</span><br></pre></td></tr></table></figure><p>例如</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -H &#39;Content-Type: application&#x2F;json&#39; -XPOST &quot;https:&#x2F;&#x2F;localhost:9200&#x2F;_bulk?pretty&quot; -u &#39;admin:admin&#39; --insecure --data-binary @data-bulk.json</span><br></pre></td></tr></table></figure><p>data-bulk.json:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;index&quot;:&#123; &quot;_index&quot;: &quot;books&quot;, &quot;_type&quot;: &quot;IT&quot;, &quot;_id&quot;: &quot;1&quot; &#125;&#125;</span><br><span class="line">&#123;&quot;id&quot;:&quot;1&quot;,&quot;title&quot;:&quot;Java Book&quot;,&quot;language&quot;:&quot;java&quot;,&quot;author&quot;:&quot;Bruce Eckel&quot;,&quot;price&quot;:70.20,&quot;year&quot;:2007,&quot;description&quot;:&quot;Java must read&quot;, &quot;tel&quot;:&quot;15313016138&quot;, &quot;d_val&quot;:&quot;2018-11-01 12:25:36&quot;&#125;</span><br><span class="line">&#123;&quot;index&quot;:&#123; &quot;_index&quot;: &quot;books&quot;, &quot;_type&quot;: &quot;IT&quot;, &quot;_id&quot;: &quot;2&quot; &#125;&#125;</span><br><span class="line">&#123;&quot;id&quot;:&quot;2&quot;,&quot;title&quot;:&quot;Java perform&quot;,&quot;language&quot;:&quot;java&quot;,&quot;author&quot;:&quot;John Li&quot;,&quot;price&quot;:46.50,&quot;year&quot;:2012,&quot;description&quot;:&quot;permformance ..&quot;, &quot;tel&quot;:&quot;13548621254&quot;, &quot;d_val&quot;:&quot;2018-11-01 08:25:50&quot;&#125;</span><br><span class="line">&#123;&quot;index&quot;:&#123; &quot;_index&quot;: &quot;books&quot;, &quot;_type&quot;: &quot;IT&quot;, &quot;_id&quot;: &quot;3&quot; &#125;&#125;</span><br><span class="line">&#123;&quot;id&quot;:&quot;3&quot;,&quot;title&quot;:&quot;Python compte&quot;,&quot;language&quot;:&quot;python&quot;,&quot;author&quot;:&quot;Tohma Ke&quot;,&quot;price&quot;:81.40,&quot;year&quot;:2016,&quot;description&quot;:&quot;py ...&quot;, &quot;tel&quot;:&quot;13245687956&quot;, &quot;d_val&quot;:&quot;2018-11-01 19:30:20&quot;&#125;</span><br><span class="line">&#123;&quot;index&quot;:&#123; &quot;_index&quot;: &quot;books&quot;, &quot;_type&quot;: &quot;IT&quot;, &quot;_id&quot;: &quot;4&quot; &#125;&#125;</span><br><span class="line">&#123;&quot;id&quot;:&quot;4&quot;,&quot;title&quot;:&quot;Python base&quot;,&quot;language&quot;:&quot;python&quot;,&quot;author&quot;:&quot;Tomash Si&quot;,&quot;price&quot;:54.50,&quot;year&quot;: 2014,&quot;description&quot;:&quot;py base....&quot;, &quot;tel&quot;:&quot;aefda1567fdsa13&quot;, &quot;d_val&quot;:&quot;2018-09-01&quot;&#125;</span><br><span class="line">&#123;&quot;index&quot;:&#123; &quot;_index&quot;: &quot;books&quot;, &quot;_type&quot;: &quot;IT&quot;, &quot;_id&quot;: &quot;5&quot; &#125;&#125;</span><br><span class="line">&#123;&quot;id&quot;:&quot;5&quot;,&quot;title&quot;:&quot;JavaScript high&quot;,&quot;language&quot;:&quot;javascript&quot;,&quot;author&quot;:&quot;Nicholas C.Zakas&quot;,&quot;price&quot;:66.40,&quot;year&quot;:2012,&quot;description&quot;:&quot;JavaScript.....&quot;, &quot;tel&quot;:&quot;a14512dfa&quot;, &quot;d_val&quot;:&quot;2018-08-01&quot;&#125;</span><br></pre></td></tr></table></figure><p>对于大量文档，将请求集中在一起并使用_bulkAPI 可提供卓越的性能。<br>但是，如果文档很大，可能需要单独为它们编制索引。</p><p>在 OpenSearch 中，数据的基本单位是 JSON文档。在索引中，OpenSearch 使用唯一 ID 标识每个文档。</p><p>当将文档添加到尚不存在的索引时，OpenSearch 会自动创建索引。如果未在请求中指定 ID，它还会自动生成一个 ID。<br>自动 ID 生成有一个明显的缺点：因为索引请求没有指定文档 ID，以后无法轻松更新文档。此外，如果运行此请求 10 次，OpenSearch 会将此文档索引为 10 个具有唯一 ID 的不同文档。<br>指定一个 ID，如果运行此命令 10 次，仍然只有一个索引的文档，该_version字段增加到 10。</p><h3 id="索引命名"><a href="#索引命名" class="headerlink" title="索引命名"></a>索引命名</h3><p>OpenSearch 索引具有以下命名限制：</p><ul><li>所有字母必须小写。</li><li>索引名称不能以下划线 ( _) 或连字符 ( -)开头。</li><li>索引名称不能包含空格、逗号或以下字符：:, “, *, +, /, , |, ?, #, &gt;, 或&lt;</li></ul><h3 id="取数据"><a href="#取数据" class="headerlink" title="取数据"></a>取数据</h3><p>索引文档后，可以通过发送 GET 请求取数据，原始文档在返回的json的_source对象中 \</p><p>例如</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -H &#39;Content-Type: application&#x2F;json&#39; -XGET &quot;https:&#x2F;&#x2F;localhost:9200&#x2F;movies&#x2F;_doc&#x2F;1&quot; -u &#39;admin:admin&#39; --insecure</span><br></pre></td></tr></table></figure><h3 id="更新数据"><a href="#更新数据" class="headerlink" title="更新数据"></a>更新数据</h3><ul><li>要更新现有字段或添加新字段，请向_update操作发送 POST 请求，并在doc对象中进行更改 </li></ul><p>例如</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">curl -H &#39;Content-Type: application&#x2F;json&#39; -XPOST &quot;https:&#x2F;&#x2F;localhost:9200&#x2F;movies&#x2F;_update&#x2F;1&quot; -u &#39;admin:admin&#39; --insecure -d &#39;</span><br><span class="line">&#123;</span><br><span class="line">  &quot;doc&quot;: &#123;</span><br><span class="line">    &quot;title&quot;: &quot;Castle in the Sky&quot;,</span><br><span class="line">    &quot;genre&quot;: [&quot;Animation&quot;, &quot;Fantasy&quot;]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;&#39;</span><br><span class="line"></span><br><span class="line"># 得到</span><br><span class="line">&#123;</span><br><span class="line">  &quot;_index&quot; : &quot;movies&quot;,</span><br><span class="line">  &quot;_type&quot; : &quot;_doc&quot;,</span><br><span class="line">  &quot;_id&quot; : &quot;1&quot;,</span><br><span class="line">  &quot;_version&quot; : 2,</span><br><span class="line">  &quot;_seq_no&quot; : 1,</span><br><span class="line">  &quot;_primary_term&quot; : 1,</span><br><span class="line">  &quot;found&quot; : true,</span><br><span class="line">  &quot;_source&quot; : &#123;</span><br><span class="line">    &quot;title&quot; : &quot;Castle in the Sky&quot;,</span><br><span class="line">    &quot;genre&quot; : [</span><br><span class="line">      &quot;Animation&quot;,</span><br><span class="line">      &quot;Fantasy&quot;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>索引的_version字段代表文档更新的次数。</p><ul><li><p>要完全替换文档，请使用 PUT 请求</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PUT movies&#x2F;_doc&#x2F;1</span><br><span class="line">&#123;</span><br><span class="line">  &quot;title&quot;: &quot;Spirited Away&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>根据文档是否已经存在有条件地更新 </p></li></ul><p>使用upsert对象。在这里，如果文档存在，则其title字段更改为Castle in the Sky。如果不是，OpenSearch 会索引upsert对象中的文档。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">POST movies&#x2F;_update&#x2F;2</span><br><span class="line">&#123;</span><br><span class="line">  &quot;doc&quot;: &#123;</span><br><span class="line">    &quot;title&quot;: &quot;Castle in the Sky&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;upsert&quot;: &#123;</span><br><span class="line">    &quot;title&quot;: &quot;Only Yesterday&quot;,</span><br><span class="line">    &quot;genre&quot;: [&quot;Animation&quot;, &quot;Fantasy&quot;],</span><br><span class="line">    &quot;date&quot;: 1993</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h3><p>要从索引中删除文档，请使用 DELETE 请求：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE movies&#x2F;_doc&#x2F;1</span><br></pre></td></tr></table></figure><p>之后如果再查询，就会得到found=false</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -H &#39;Content-Type: application&#x2F;json&#39; -XGET &quot;https:&#x2F;&#x2F;localhost:9200&#x2F;movies&#x2F;_doc&#x2F;1&quot; -u &#39;admin:admin&#39; --insecure</span><br><span class="line">&#123;&quot;_index&quot;:&quot;movies&quot;,&quot;_type&quot;:&quot;_doc&quot;,&quot;_id&quot;:&quot;1&quot;,&quot;found&quot;:false&#125;#</span><br></pre></td></tr></table></figure><h3 id="索引配置"><a href="#索引配置" class="headerlink" title="索引配置"></a>索引配置</h3><p>直接提供数据其实是采用了默认的索引配置，其实可以创建自定义的index，参见近似KNN搜索的index创建</p><h3 id="索引别名"><a href="#索引别名" class="headerlink" title="索引别名"></a>索引别名</h3><p>如果数据分布在多个索引中，而不是跟踪要查询的索引，可以创建一个别名并对其进行查询。</p><p>例如，如果将日志存储到基于月份的索引中，并且经常查询前两个月的日志，可以创建一个last_2_months别名并更新它指向的每个月的索引。</p><p>因为可以随时更改别名指向的索引，所以在应用程序中使用别名引用索引可以在不停机的情况下重新索引数据。</p><p>TBD</p><h2 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h2><p>cheatsheet: <a href="https://www.jianshu.com/p/3cb205b5354a">https://www.jianshu.com/p/3cb205b5354a</a> \</p><p><a href="https://elasticsearch-cheatsheet.jolicode.com/">https://elasticsearch-cheatsheet.jolicode.com/</a></p><h3 id="多字段包含关系"><a href="#多字段包含关系" class="headerlink" title="多字段包含关系"></a>多字段包含关系</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">curl -H &#39;Content-Type: application&#x2F;json&#39; -XPOST &quot;https:&#x2F;&#x2F;localhost:9200&#x2F;books&#x2F;_search?pretty&#x3D;true&quot; -u &#39;admin:admin&#39; --insecure -d &#39;&#123;&quot;query&quot;: &#123;</span><br><span class="line">      &quot;bool&quot;: &#123;</span><br><span class="line">           &quot;must&quot;: [</span><br><span class="line">                 &#123; &quot;match&quot;: &#123; &quot;port&quot;:  &quot;9083&quot; &#125;&#125;, # 这里是包含关系，port字段里只要有9083就是true</span><br><span class="line">                 &#123; &quot;match&quot;: &#123; &quot;name&quot;: &quot;tt_vod_program_play_test&quot; &#125;&#125;,</span><br><span class="line">                 &#123; &quot;match&quot;: &#123; &quot;s_timestamp&quot;: &quot;1545719719164&quot; &#125;&#125;</span><br><span class="line">            ]</span><br><span class="line">       &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;size&quot;: 10&#125;&#39;</span><br></pre></td></tr></table></figure><h3 id="查询数字范围"><a href="#查询数字范围" class="headerlink" title="查询数字范围"></a>查询数字范围</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-d &#39;&#123;  </span><br><span class="line">    &quot;query&quot;: &#123;</span><br><span class="line">        &quot;range&quot; : &#123;</span><br><span class="line">            &quot;price&quot; : &#123;</span><br><span class="line">                &quot;gte&quot; : 50,</span><br><span class="line">                &quot;lte&quot; : 70</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;&#39;</span><br></pre></td></tr></table></figure><h3 id="近似KNN搜索"><a href="#近似KNN搜索" class="headerlink" title="近似KNN搜索"></a>近似KNN搜索</h3><p>一旦数据集超过数十万个向量，精确KNN开销太大，需要采用近似KNN算法。</p><p>近似knn算法的benchmark参考：<a href="https://github.com/erikbern/ann-benchmarks/">https://github.com/erikbern/ann-benchmarks/</a></p><ul><li>首先需要创建一种索引，其index.knn设置为true，然后添加一个或多个类型为knn_vector的字段</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">curl -H &#39;Content-Type: application&#x2F;json&#39;  -u &#39;admin:admin&#39; --insecure -X PUT &quot;https:&#x2F;&#x2F;localhost:9200&#x2F;my-knn-index-1&quot; -d &#39;&#123;</span><br><span class="line">  &quot;settings&quot;: &#123;</span><br><span class="line">    &quot;number_of_shards&quot;: 5,</span><br><span class="line">    &quot;number_of_replicas&quot;: 0,</span><br><span class="line">    &quot;index&quot;: &#123;</span><br><span class="line">      &quot;knn&quot;: true,</span><br><span class="line">      &quot;knn.algo_param.ef_search&quot;: 100</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;mappings&quot;: &#123;</span><br><span class="line">    &quot;properties&quot;: &#123;</span><br><span class="line">        &quot;my_vector1&quot;: &#123;</span><br><span class="line">          &quot;type&quot;: &quot;knn_vector&quot;,</span><br><span class="line">          &quot;dimension&quot;: 2,</span><br><span class="line">          &quot;method&quot;: &#123;</span><br><span class="line">            &quot;name&quot;: &quot;hnsw&quot;,</span><br><span class="line">            &quot;space_type&quot;: &quot;l2&quot;,</span><br><span class="line">            &quot;engine&quot;: &quot;nmslib&quot;,</span><br><span class="line">            &quot;parameters&quot;: &#123;</span><br><span class="line">              &quot;ef_construction&quot;: 128,</span><br><span class="line">              &quot;m&quot;: 24</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;my_vector2&quot;: &#123;</span><br><span class="line">          &quot;type&quot;: &quot;knn_vector&quot;,</span><br><span class="line">          &quot;dimension&quot;: 4,</span><br><span class="line">          &quot;method&quot;: &#123;</span><br><span class="line">            &quot;name&quot;: &quot;hnsw&quot;,</span><br><span class="line">            &quot;space_type&quot;: &quot;cosinesimil&quot;,</span><br><span class="line">            &quot;engine&quot;: &quot;nmslib&quot;,</span><br><span class="line">            &quot;parameters&quot;: &#123;</span><br><span class="line">              &quot;ef_construction&quot;: 256,</span><br><span class="line">              &quot;m&quot;: 48</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;&#39;</span><br></pre></td></tr></table></figure><p>构造数据示例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123; &quot;index&quot;: &#123; &quot;_index&quot;: &quot;my-knn-index-1&quot;, &quot;_id&quot;: &quot;1&quot; &#125; &#125;</span><br><span class="line">&#123; &quot;my_vector1&quot;: [1.5, 2.5], &quot;price&quot;: 12.2, &quot;hash&quot;: &quot;deadbeef&quot; &#125;</span><br><span class="line">&#123; &quot;index&quot;: &#123; &quot;_index&quot;: &quot;my-knn-index-1&quot;, &quot;_id&quot;: &quot;2&quot; &#125; &#125;</span><br><span class="line">&#123; &quot;my_vector1&quot;: [2.5, 3.5], &quot;price&quot;: 7.1, &quot;hash&quot;: &quot;deadbeee&quot; &#125;</span><br><span class="line">&#123; &quot;index&quot;: &#123; &quot;_index&quot;: &quot;my-knn-index-1&quot;, &quot;_id&quot;: &quot;3&quot; &#125; &#125;</span><br><span class="line">&#123; &quot;my_vector1&quot;: [3.5, 4.5], &quot;price&quot;: 12.9, &quot;hash&quot;: &quot;deadbeed&quot; &#125;</span><br><span class="line">&#123; &quot;index&quot;: &#123; &quot;_index&quot;: &quot;my-knn-index-1&quot;, &quot;_id&quot;: &quot;4&quot; &#125; &#125;</span><br><span class="line">&#123; &quot;my_vector1&quot;: [5.5, 6.5], &quot;price&quot;: 1.2, &quot;hash&quot;: &quot;deadbeec&quot; &#125;</span><br><span class="line">&#123; &quot;index&quot;: &#123; &quot;_index&quot;: &quot;my-knn-index-1&quot;, &quot;_id&quot;: &quot;5&quot; &#125; &#125;</span><br><span class="line">&#123; &quot;my_vector1&quot;: [4.5, 5.5], &quot;price&quot;: 3.7, &quot;hash&quot;: &quot;deadbeeb&quot; &#125;</span><br><span class="line">&#123; &quot;index&quot;: &#123; &quot;_index&quot;: &quot;my-knn-index-1&quot;, &quot;_id&quot;: &quot;6&quot; &#125; &#125;</span><br><span class="line">&#123; &quot;my_vector2&quot;: [1.5, 5.5, 4.5, 6.4], &quot;price&quot;: 10.3, &quot;hash&quot;: &quot;deadbeea&quot; &#125;</span><br><span class="line">&#123; &quot;index&quot;: &#123; &quot;_index&quot;: &quot;my-knn-index-1&quot;, &quot;_id&quot;: &quot;7&quot; &#125; &#125;</span><br><span class="line">&#123; &quot;my_vector2&quot;: [2.5, 3.5, 5.6, 6.7], &quot;price&quot;: 5.5, &quot;hash&quot;: &quot;deadbee0&quot; &#125;</span><br><span class="line">&#123; &quot;index&quot;: &#123; &quot;_index&quot;: &quot;my-knn-index-1&quot;, &quot;_id&quot;: &quot;8&quot; &#125; &#125;</span><br><span class="line">&#123; &quot;my_vector2&quot;: [4.5, 5.5, 6.7, 3.7], &quot;price&quot;: 4.4, &quot;hash&quot;: &quot;deadbedf&quot; &#125;</span><br><span class="line">&#123; &quot;index&quot;: &#123; &quot;_index&quot;: &quot;my-knn-index-1&quot;, &quot;_id&quot;: &quot;9&quot; &#125; &#125;</span><br><span class="line">&#123; &quot;my_vector2&quot;: [1.5, 5.5, 4.5, 6.4], &quot;price&quot;: 8.9, &quot;hash&quot;: &quot;deadbede&quot; &#125;</span><br></pre></td></tr></table></figure><p>然后搜索：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">GET my-knn-index-1&#x2F;_search</span><br><span class="line">&#123;</span><br><span class="line">  &quot;size&quot;: 2,</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;knn&quot;: &#123;</span><br><span class="line">      &quot;my_vector2&quot;: &#123;</span><br><span class="line">        &quot;vector&quot;: [2, 3, 5, 6],</span><br><span class="line">        &quot;k&quot;: 2</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;post_filter&quot;: &#123;</span><br><span class="line">    &quot;range&quot;: &#123;</span><br><span class="line">      &quot;price&quot;: &#123;</span><br><span class="line">        &quot;gte&quot;: 5,</span><br><span class="line">        &quot;lte&quot;: 10</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>性能优化</li></ul><ul><li><p>在创建索引时禁用刷新间隔</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PUT &#x2F;&lt;index_name&gt;&#x2F;_settings</span><br><span class="line">&#123;</span><br><span class="line">    &quot;index&quot; : &#123;</span><br><span class="line">        &quot;refresh_interval&quot; : &quot;-1&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>索引建完记得重新启用！</p></li><li><p>增加线程数<br> 在创建索引时，使用knn.algo_param.index_thread_qty设置要分配的线程数。</p></li><li><p>增加分片（shard）数，以减小每个分片中的段（section）数，从而增强并行化：在创建索引的时候进行配置：</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot;settings&quot;: &#123;</span><br><span class="line">  &quot;number_of_shards&quot;: 2,</span><br><span class="line">  &quot;number_of_replicas&quot;: 1</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p> 注意，Elastic 官方博客文章建议：堆内存和分片的配置比例为1:20，举例：30GB堆内存，最多可有600个分片。 <br> <a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.0/misc-cluster.html#cluster-shard-limit">https://www.elastic.co/guide/en/elasticsearch/reference/7.0/misc-cluster.html#cluster-shard-limit</a> <br> <a href="https://github.com/elastic/kibana/issues/35529">https://github.com/elastic/kibana/issues/35529</a> \</p></li><li><p>预热索引</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F;_plugins&#x2F;_knn&#x2F;warmup&#x2F;index1,index2,index3?pretty</span><br><span class="line">&#123;</span><br><span class="line">&quot;_shards&quot; : &#123;</span><br><span class="line">    &quot;total&quot; : 6,</span><br><span class="line">    &quot;successful&quot; : 6,</span><br><span class="line">    &quot;failed&quot; : 0</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ElasticSearch&quot;&gt;&lt;a href=&quot;#ElasticSearch&quot; class=&quot;headerlink&quot; title=&quot;ElasticSearch&quot;&gt;&lt;/a&gt;ElasticSearch&lt;/h1&gt;&lt;p&gt;Elasticsearch 是一个开源的搜索引擎，建</summary>
      
    
    
    
    
    <category term="Tools" scheme="https://learner0x5a.github.io/tags/Tools/"/>
    
  </entry>
  
  <entry>
    <title>MySQL Note</title>
    <link href="https://learner0x5a.github.io/2021/09/02/mysql/"/>
    <id>https://learner0x5a.github.io/2021/09/02/mysql/</id>
    <published>2021-09-02T09:09:24.000Z</published>
    <updated>2021-09-02T09:20:50.464Z</updated>
    
    <content type="html"><![CDATA[<h1 id="MySQL的迁移"><a href="#MySQL的迁移" class="headerlink" title="MySQL的迁移"></a>MySQL的迁移</h1><h2 id="导出"><a href="#导出" class="headerlink" title="导出"></a>导出</h2><p><code>.\mysqldump.exe -u root -p database_name table_name &gt; table_name.sql</code></p><p><code>.\mysqldump.exe -u root -p database_name table_name -r table_name.sql</code></p><h2 id="导入"><a href="#导入" class="headerlink" title="导入"></a>导入</h2><p><code>mysql -u root -p database_name &lt; table_name.sql</code></p><h2 id="场景：从windows迁移到ubuntu"><a href="#场景：从windows迁移到ubuntu" class="headerlink" title="场景：从windows迁移到ubuntu"></a>场景：从windows迁移到ubuntu</h2><p>一开始用powershell：</p><p><code>.\mysqldump.exe -u root -p database_name table_name &gt; table_name.sql</code></p><p>但是在ubuntu里导入的时候报错：</p><p><code>ERROR: ASCII &#39;\0&#39; appeared in the statement, but this is not allowed unless option --binary-mode ...</code></p><p>查了一下发现是powershell的原因：由于写出用的是重定向，而powershell的默认编码是UTF-16，导致ubuntu导入的时候不认识 <br>用<code>file</code>看一下，可以发现确实如此</p><p><code>Little-endian UTF-16 Unicode text, with very long lines, with CRLF line terminators.</code></p><p>解决方案是，不采用重定向写出：</p><p><code>.\mysqldump.exe -u root -p database_name table_name -r table_name.sql</code></p><p><code>file</code>的结果是：</p><p><code>ISO-8859 text, with very long lines</code>或者<code>ASCII text</code></p><p>然后导入：</p><p><code>mysql -u root -p database_name &lt; table_name.sql</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;MySQL的迁移&quot;&gt;&lt;a href=&quot;#MySQL的迁移&quot; class=&quot;headerlink&quot; title=&quot;MySQL的迁移&quot;&gt;&lt;/a&gt;MySQL的迁移&lt;/h1&gt;&lt;h2 id=&quot;导出&quot;&gt;&lt;a href=&quot;#导出&quot; class=&quot;headerlink&quot; titl</summary>
      
    
    
    
    
    <category term="database" scheme="https://learner0x5a.github.io/tags/database/"/>
    
  </entry>
  
  <entry>
    <title>机器学习中分类问题的数据均衡</title>
    <link href="https://learner0x5a.github.io/2021/08/26/data-balance/"/>
    <id>https://learner0x5a.github.io/2021/08/26/data-balance/</id>
    <published>2021-08-26T11:00:57.000Z</published>
    <updated>2021-08-27T13:01:14.193Z</updated>
    
    <content type="html"><![CDATA[<h1 id="问题：真实世界的数据分布不一定均衡，那为什么大多数ML-DL要做数据均衡？"><a href="#问题：真实世界的数据分布不一定均衡，那为什么大多数ML-DL要做数据均衡？" class="headerlink" title="问题：真实世界的数据分布不一定均衡，那为什么大多数ML/DL要做数据均衡？"></a><strong>问题：真实世界的数据分布不一定均衡，那为什么大多数ML/DL要做数据均衡？</strong></h1><p>答案：根据场景来决定是否要数据均衡</p><h2 id="场景1-癌症二分类"><a href="#场景1-癌症二分类" class="headerlink" title="场景1: 癌症二分类"></a>场景1: 癌症二分类</h2><p>真实数据分布是：绝大多数人没有癌症，极少数人有癌症；如果不做数据均衡，那么一个ML分类器会倾向于把所有样本判断成没有癌症，即全是漏报，没有误报 <br>在辅助医生诊断时，显然是不行的：可以有误报，尽量没有漏报；<br>所以在训练模型时要做数据均衡。</p><h2 id="场景2-英文字母识别"><a href="#场景2-英文字母识别" class="headerlink" title="场景2: 英文字母识别"></a>场景2: 英文字母识别</h2><p>真实数据分布不是均匀分布，高频字母例如e，低频字母例如v；</p><p>如果做数据均衡，那么训练后的分类器对于每个字母分类错误的概率都是一样的； <br>如果不做数据均衡，那么训练后的分类器对于每个字母分类错误的概率不一样，错误概率的分布应该是接近字母的分布； <br>所以要根据场景做选择，例如做文本识别，高频字母识别准确率比低频字母准确率更重要，所以不能做数据均衡。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>分类错误概率的分布和训练数据的分布具有一致性，所以要不要做数据均衡，要由场景来决定。</p><h1 id="数据均衡方法"><a href="#数据均衡方法" class="headerlink" title="数据均衡方法"></a>数据均衡方法</h1><p>如果要做数据均衡，可以从以下几个方面考虑：</p><ul><li>数据上采样/下采样</li><li>NN：Focal Loss</li><li>NN：二分类时，可以调整分类阈值</li><li>数据合成：SMOTE算法，利用小众样本在特征空间的相似性来合成新样本</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;问题：真实世界的数据分布不一定均衡，那为什么大多数ML-DL要做数据均衡？&quot;&gt;&lt;a href=&quot;#问题：真实世界的数据分布不一定均衡，那为什么大多数ML-DL要做数据均衡？&quot; class=&quot;headerlink&quot; title=&quot;问题：真实世界的数据分布不一定均衡，</summary>
      
    
    
    
    
    <category term="AI" scheme="https://learner0x5a.github.io/tags/AI/"/>
    
  </entry>
  
  <entry>
    <title>Hyper-V挂载共享文件夹</title>
    <link href="https://learner0x5a.github.io/2021/08/16/hyper-share/"/>
    <id>https://learner0x5a.github.io/2021/08/16/hyper-share/</id>
    <published>2021-08-16T09:33:42.000Z</published>
    <updated>2021-08-16T09:42:11.714Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Windows-Host-Ubuntu-Guest"><a href="#Windows-Host-Ubuntu-Guest" class="headerlink" title="Windows Host + Ubuntu Guest"></a>Windows Host + Ubuntu Guest</h1><h1 id="Host配置"><a href="#Host配置" class="headerlink" title="Host配置"></a>Host配置</h1><p>在资源管理器中的<strong>磁盘</strong>，例如<code>D:\</code>上右键-属性-共享-高级共享-<strong>勾选</strong>共享此文件夹，记一下网络路径，比如<code>Desktop-jpjdlkr\d</code></p><p>其实可以对磁盘中具体的某个文件夹开启共享，但实测发现，当文件夹中的文件过大/过多的时候会失败（未知原因）</p><h1 id="Guest访问"><a href="#Guest访问" class="headerlink" title="Guest访问"></a>Guest访问</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Ubuntu 18.04</span></span><br><span class="line">sudo apt install cifs-utils</span><br><span class="line"><span class="comment"># 用ip访问</span></span><br><span class="line">sudo mount.cifs //&lt;host_ip&gt;/d /path/to/mnt_destination -o user=&lt;Username&gt;</span><br><span class="line"><span class="comment"># 然后输入密码即可</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Windows-Host-Ubuntu-Guest&quot;&gt;&lt;a href=&quot;#Windows-Host-Ubuntu-Guest&quot; class=&quot;headerlink&quot; title=&quot;Windows Host + Ubuntu Guest&quot;&gt;&lt;/a&gt;Windows H</summary>
      
    
    
    
    
    <category term="Tools" scheme="https://learner0x5a.github.io/tags/Tools/"/>
    
  </entry>
  
  <entry>
    <title>小米6搞机:BootLoader+Root+Magisk</title>
    <link href="https://learner0x5a.github.io/2021/06/25/magisk/"/>
    <id>https://learner0x5a.github.io/2021/06/25/magisk/</id>
    <published>2021-06-25T07:55:44.000Z</published>
    <updated>2021-06-25T09:15:54.062Z</updated>
    
    <content type="html"><![CDATA[<h1 id="解锁-Root"><a href="#解锁-Root" class="headerlink" title="解锁+Root"></a>解锁+Root</h1><p>去官网申请解锁<a href="http://www.miui.com/unlock/index.html">bootloader</a><br>下载解锁工具（注意，解锁工具需要登录，先登录再进fastboot！）<br>刷机，由于我之前申请了MIUI12的内测，需要降级回MIUI10开发版，即官网给出的小米6最高的<a href="http://www.miui.com/download-330.html">开发版</a><br>为了获取完全root权限，可以修改system分区，使用<a href="https://developer.android.com/studio/releases/platform-tools">adb</a>解锁system<br>需要打开开发者选项中的USB调试，USB安装，USB调试(安全设置)，关闭“启用MIUI优化”。 </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">adb.exe root</span><br><span class="line">adb.exe disable-verity</span><br></pre></td></tr></table></figure><p>如果需要用adb传文件可以使用<code>adb push file_on_pc dir_on_phone</code>命令<br>例如</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.\adb.exe push .\Magisk-v23.0.apk &#x2F;sdcard&#x2F;Download&#x2F;</span><br><span class="line">.\adb.exe push .\MagiskManager-v5.8.1.apk &#x2F;sdcard&#x2F;Download&#x2F;</span><br><span class="line">.\adb.exe push .\igniter-0.10.2-beta.apk &#x2F;sdcard&#x2F;Download&#x2F;</span><br></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/Aaron_Miller/article/details/106885294">参考</a></p><h1 id="Magisk"><a href="#Magisk" class="headerlink" title="Magisk"></a>Magisk</h1><p><a href="https://sspai.com/post/53043/">参考1:Magisk初识与安装</a><br><a href="https://www.bilibili.com/read/cv3310322/">参考2:小米6刷入Recovery</a></p><p>TWRP是第三方recovery，但厂商认可。<br>利用TWRP安装Magisk，先去下载<a href="https://twrp.me/xiaomi/xiaomimi6.html">TWRP</a> </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">执行 adb reboot bootloader 进入 Bootloader 界面</span><br><span class="line">执行 fastboot boot TWRP.img 进入临时 TWRP</span><br><span class="line">在 TWRP 中刷入你下载的 Magisk 安装包</span><br></pre></td></tr></table></figure><p>去github下载<a href="https://github.com/topjohnwu/Magisk/releases">Magisk</a>和<a href="https://github.com/topjohnwu/MagiskManager/releases">MagiskManager</a><br>然后用adb把这两个安装包传到手机里面去<br>然后在TWRP里面安装Magisk，重启，进入MIUI后安装MagiskManager<br>打开MagiskManager之后，会检查更新若干次，直到升级Manager到最新版本。<br>后续可以考虑<a href="https://blog.csdn.net/qq_37068181/article/details/112368793">在Magisk里面再装个xposed</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;解锁-Root&quot;&gt;&lt;a href=&quot;#解锁-Root&quot; class=&quot;headerlink&quot; title=&quot;解锁+Root&quot;&gt;&lt;/a&gt;解锁+Root&lt;/h1&gt;&lt;p&gt;去官网申请解锁&lt;a href=&quot;http://www.miui.com/unlock/index.h</summary>
      
    
    
    
    
    <category term="others" scheme="https://learner0x5a.github.io/tags/others/"/>
    
  </entry>
  
  <entry>
    <title>HTML, CSS 和 JavaScript</title>
    <link href="https://learner0x5a.github.io/2021/05/27/web-dev/"/>
    <id>https://learner0x5a.github.io/2021/05/27/web-dev/</id>
    <published>2021-05-27T06:35:12.000Z</published>
    <updated>2021-05-27T15:00:22.440Z</updated>
    
    <content type="html"><![CDATA[<h1 id="web开发"><a href="#web开发" class="headerlink" title="web开发"></a>web开发</h1><h2 id="HTML-定义了网页的内容"><a href="#HTML-定义了网页的内容" class="headerlink" title="HTML 定义了网页的内容"></a>HTML 定义了网页的内容</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>菜鸟教程(runoob.com)<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>我的第一个标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>我的第一个段落。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">&quot;demo&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://www.runoob.com&quot;</span>&gt;</span>这是一个链接<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">loading</span>=<span class="string">&quot;lazy&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/images/logo.png&quot;</span> <span class="attr">width</span>=<span class="string">&quot;258&quot;</span> <span class="attr">height</span>=<span class="string">&quot;39&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>各个元素的说明：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span> 声明为 HTML5 文档</span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span> 元素是 HTML 页面的根元素</span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span> 元素包含了文档的元（meta）数据，如 <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span> 定义网页编码格式为 utf-8。</span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span> 元素描述了文档的标题</span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span> 元素包含了可见的页面内容</span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span> 元素定义一个大标题</span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span> 元素定义一个段落</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span>&gt;</span> 元素定义一个链接</span><br><span class="line"><span class="tag">&lt;<span class="name">img</span>&gt;</span> 元素定义一个图片</span><br></pre></td></tr></table></figure><h3 id="HTML-属性"><a href="#HTML-属性" class="headerlink" title="HTML 属性"></a>HTML 属性</h3><p>HTML元素可以设置属性 </p><p>属性可以在元素中添加附加信息 </p><p>属性一般描述于开始标签 </p><p>属性总是以名称/值对的形式出现，比如：name=”value”; href=”<a href="https://www.runoob.com&quot;/">https://www.runoob.com&quot;</a>; id=”demo” </p><p>属性之间空格分开</p><h2 id="CSS-描述了网页的布局"><a href="#CSS-描述了网页的布局" class="headerlink" title="CSS 描述了网页的布局"></a>CSS 描述了网页的布局</h2><p>CSS其实是HTML的<code>&lt;style&gt;</code>元素</p><h3 id="内部样式表-Internal-style-sheet"><a href="#内部样式表-Internal-style-sheet" class="headerlink" title="内部样式表(Internal style sheet)"></a>内部样式表(Internal style sheet)</h3><p>在HTML的<code>&lt;head&gt;</code>段定义各个元素的<code>&lt;style&gt;</code>：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css"><span class="selector-tag">hr</span> &#123;<span class="attribute">color</span>:sienna;&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">p</span> &#123;<span class="attribute">margin-left</span>:<span class="number">20px</span>;&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">body</span> &#123;<span class="attribute">background-image</span>:<span class="built_in">url</span>(<span class="string">&quot;images/back40.gif&quot;</span>);&#125;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="外部样式表-External-style-sheet"><a href="#外部样式表-External-style-sheet" class="headerlink" title="外部样式表(External style sheet)"></a>外部样式表(External style sheet)</h3><p>为了迁移方便，独立出去成为一个CSS文件，在HTML中<code>&lt;head&gt;</code>部分用<code>&lt;link&gt;</code>引用：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">href</span>=<span class="string">&quot;mystyle.css&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure><p>CSS文件：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hr &#123;color:sienna;&#125;</span><br><span class="line">p &#123;margin-left:20px;&#125;</span><br><span class="line">body &#123;background-image:url(&quot;/images/back40.gif&quot;);&#125;</span><br></pre></td></tr></table></figure><h3 id="内联样式-Inline-style"><a href="#内联样式-Inline-style" class="headerlink" title="内联样式(Inline style)"></a>内联样式(Inline style)</h3><p>直接在HTML元素里设置属性：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&quot;color:sienna;margin-left:20px&quot;</span>&gt;</span>这是一个段落。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="JavaScript-控制了网页的行为"><a href="#JavaScript-控制了网页的行为" class="headerlink" title="JavaScript 控制了网页的行为"></a>JavaScript 控制了网页的行为</h2><p>JS是HTML的<code>&lt;script&gt;</code>元素：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>菜鸟教程(runoob.com)<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">displayDate</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">document</span>.getElementById(<span class="string">&quot;demo&quot;</span>).innerHTML=<span class="built_in">Date</span>();</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>我的第一个 JavaScript 程序<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;demo&quot;</span>&gt;</span>这是一个段落<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;displayDate()&quot;</span>&gt;</span>显示日期<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="JS可以直接写HTML"><a href="#JS可以直接写HTML" class="headerlink" title="JS可以直接写HTML"></a>JS可以直接写HTML</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>菜鸟教程(runoob.com)<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">JavaScript 能够直接写入 HTML 输出流中：</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="built_in">document</span>.write(<span class="string">&quot;&lt;h1&gt;这是一个标题&lt;/h1&gt;&quot;</span>);</span></span><br><span class="line"><span class="javascript"><span class="built_in">document</span>.write(<span class="string">&quot;&lt;p&gt;这是一个段落。&lt;/p&gt;&quot;</span>);</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">您只能在 HTML 输出流中使用 <span class="tag">&lt;<span class="name">strong</span>&gt;</span>document.write<span class="tag">&lt;/<span class="name">strong</span>&gt;</span>。</span><br><span class="line">如果您在文档已加载后使用它（比如在函数中），会覆盖整个文档。</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="JS可以对事件作出反应"><a href="#JS可以对事件作出反应" class="headerlink" title="JS可以对事件作出反应"></a>JS可以对事件作出反应</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>菜鸟教程(runoob.com)<span class="tag">&lt;/<span class="name">title</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>我的第一个 JavaScript<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">JavaScript 能够对事件作出反应。比如对按钮的点击：</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;alert(&#x27;欢迎!&#x27;)&quot;</span>&gt;</span>点我!<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="JS可以改变HTML的元素"><a href="#JS可以改变HTML的元素" class="headerlink" title="JS可以改变HTML的元素"></a>JS可以改变HTML的元素</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>菜鸟教程(runoob.com)<span class="tag">&lt;/<span class="name">title</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>我的第一段 JavaScript<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;demo&quot;</span>&gt;</span></span><br><span class="line">JavaScript 能改变 HTML 元素的内容。</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params"></span>)</span></span></span><br><span class="line">&#123;</span><br><span class="line"><span class="javascript">    x=<span class="built_in">document</span>.getElementById(<span class="string">&quot;demo&quot;</span>);  <span class="comment">// 找到元素</span></span></span><br><span class="line"><span class="javascript">    x.innerHTML=<span class="string">&quot;Hello JavaScript!&quot;</span>;    <span class="comment">// 改变内容</span></span></span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;myFunction()&quot;</span>&gt;</span>点击这里<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="JS可以改变HTML图像"><a href="#JS可以改变HTML图像" class="headerlink" title="JS可以改变HTML图像"></a>JS可以改变HTML图像</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">changeImage</span>(<span class="params"></span>)</span></span></span><br><span class="line">&#123;</span><br><span class="line"><span class="javascript">    element=<span class="built_in">document</span>.getElementById(<span class="string">&#x27;myimage&#x27;</span>)</span></span><br><span class="line"><span class="javascript">    <span class="keyword">if</span> (element.src.match(<span class="string">&quot;bulbon&quot;</span>))</span></span><br><span class="line">    &#123;</span><br><span class="line"><span class="javascript">        element.src=<span class="string">&quot;/images/pic_bulboff.gif&quot;</span>;</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="javascript">    <span class="keyword">else</span></span></span><br><span class="line">    &#123;</span><br><span class="line"><span class="javascript">        element.src=<span class="string">&quot;/images/pic_bulbon.gif&quot;</span>;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">loading</span>=<span class="string">&quot;lazy&quot;</span> <span class="attr">id</span>=<span class="string">&quot;myimage&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;changeImage()&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/images/pic_bulboff.gif&quot;</span> <span class="attr">width</span>=<span class="string">&quot;100&quot;</span> <span class="attr">height</span>=<span class="string">&quot;180&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="JS可以改变HTML样式"><a href="#JS可以改变HTML样式" class="headerlink" title="JS可以改变HTML样式"></a>JS可以改变HTML样式</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params"></span>)</span></span></span><br><span class="line">&#123;</span><br><span class="line"><span class="javascript">    x=<span class="built_in">document</span>.getElementById(<span class="string">&quot;demo&quot;</span>) <span class="comment">// 找到元素</span></span></span><br><span class="line"><span class="javascript">    x.style.color=<span class="string">&quot;#ff0000&quot;</span>;          <span class="comment">// 改变样式</span></span></span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="JS可以验证用户输入"><a href="#JS可以验证用户输入" class="headerlink" title="JS可以验证用户输入"></a>JS可以验证用户输入</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>菜鸟教程(runoob.com)<span class="tag">&lt;/<span class="name">title</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>我的第一段 JavaScript<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>请输入数字。如果输入值不是数字，浏览器会弹出提示框。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;demo&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params"></span>)</span></span></span><br><span class="line">&#123;</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> x=<span class="built_in">document</span>.getElementById(<span class="string">&quot;demo&quot;</span>).value;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">if</span>(<span class="built_in">isNaN</span>(x)||x.replace(<span class="regexp">/(^\s*)|(\s*$)/g</span>,<span class="string">&quot;&quot;</span>)==<span class="string">&quot;&quot;</span>)&#123;</span></span><br><span class="line"><span class="javascript">        alert(<span class="string">&quot;不是数字&quot;</span>);</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;myFunction()&quot;</span>&gt;</span>点击这里<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="HTML-DOM-文档对象模型"><a href="#HTML-DOM-文档对象模型" class="headerlink" title="HTML DOM (文档对象模型)"></a>HTML DOM (文档对象模型)</h2><p>DOM（Document Object Model）定义了访问 HTML 和 XML 文档的标准：</p><ul><li>核心 DOM - 针对任何结构化文档的标准模型</li><li>XML DOM - 针对 XML 文档的标准模型</li><li>HTML DOM - 针对 HTML 文档的标准模型</li></ul><p>HTML DOM 定义了所有 HTML 元素的对象和属性，以及访问它们的方法。</p><h3 id="编程接口"><a href="#编程接口" class="headerlink" title="编程接口"></a>编程接口</h3><p>可通过 JavaScript （以及其他编程语言）对 HTML DOM 进行访问。 <br>前述JS代码即为JS DOM，利用JS改变HTML的内容。</p><h1 id="Note"><a href="#Note" class="headerlink" title="Note"></a>Note</h1><p>markdown里写html代码时不能顶格，要给缩进，元素语句要加引号，作为代码出现，不然网页加载不出来。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;web开发&quot;&gt;&lt;a href=&quot;#web开发&quot; class=&quot;headerlink&quot; title=&quot;web开发&quot;&gt;&lt;/a&gt;web开发&lt;/h1&gt;&lt;h2 id=&quot;HTML-定义了网页的内容&quot;&gt;&lt;a href=&quot;#HTML-定义了网页的内容&quot; class=&quot;header</summary>
      
    
    
    
    
    <category term="BookReading" scheme="https://learner0x5a.github.io/tags/BookReading/"/>
    
  </entry>
  
  <entry>
    <title>pytorch笔记</title>
    <link href="https://learner0x5a.github.io/2021/04/07/pytorch-notes/"/>
    <id>https://learner0x5a.github.io/2021/04/07/pytorch-notes/</id>
    <published>2021-04-07T15:38:24.000Z</published>
    <updated>2021-04-08T14:42:24.414Z</updated>
    
    <content type="html"><![CDATA[<h1 id="官方教程-Learn-PyTorch-with-Examples"><a href="#官方教程-Learn-PyTorch-with-Examples" class="headerlink" title="官方教程 Learn PyTorch with Examples"></a>官方教程 Learn PyTorch with Examples</h1><p><a href="https://pytorch.org/tutorials/beginner/pytorch_with_examples.html">https://pytorch.org/tutorials/beginner/pytorch_with_examples.html</a></p><h1 id="PyTorch-Batch训练的一些笔记"><a href="#PyTorch-Batch训练的一些笔记" class="headerlink" title="PyTorch Batch训练的一些笔记"></a>PyTorch Batch训练的一些笔记</h1><p>根据可视化结果，batch size越小，得到的分类边界更精细，收敛更好，但收敛越慢，batch size过小，就会导致震荡甚至无法收敛。<br>batch size越大，收敛越快，但分类边界比较粗糙。</p><h1 id="调用指定的GPU"><a href="#调用指定的GPU" class="headerlink" title="调用指定的GPU"></a>调用指定的GPU</h1><p>直接终端中设定</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CUDA_VISIBLE_DEVICES=1 python3 main.py</span><br></pre></td></tr></table></figure><h1 id="torch-nonzero"><a href="#torch-nonzero" class="headerlink" title="torch.nonzero"></a>torch.nonzero</h1><p>torch.nonzero() 找出tensor中非零的元素的索引.</p><h1 id="PyTorch-梯度传播的笔记"><a href="#PyTorch-梯度传播的笔记" class="headerlink" title="PyTorch 梯度传播的笔记"></a>PyTorch 梯度传播的笔记</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">tensor = torch.FloatTensor([[<span class="number">1</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">4</span>]])  </span><br><span class="line">tensor.requires_grad=<span class="literal">True</span>  </span><br><span class="line">mean_out = torch.mean(tensor*tensor)       <span class="comment"># x^2  </span></span><br><span class="line">max_out = torch.<span class="built_in">max</span>(tensor*tensor)  </span><br><span class="line">  </span><br><span class="line">print(mean_out)  <span class="comment"># tensor(7.5000, grad_fn=&lt;MeanBackward0&gt;)  </span></span><br><span class="line">print(max_out)  <span class="comment"># tensor(16., grad_fn=&lt;MaxBackward1&gt;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 每次backward会自动销毁计算图</span></span><br><span class="line">mean_out.backward()    <span class="comment"># 反向传播; 这里不用retain_graph=True，因为mean_out和max_out是不同的计算图；这里只销毁mean_out</span></span><br><span class="line">print(tensor.grad)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">tensor([[0.5000, 1.0000],</span></span><br><span class="line"><span class="string">    [1.5000, 2.0000]])</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">max_out.backward(retain_graph=<span class="literal">True</span>) <span class="comment"># 自动累计梯度; 这里需要加retain_graph=True，因为下面还要用max_out</span></span><br><span class="line">print(tensor.grad)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">tensor([[ 0.5000,  1.0000],</span></span><br><span class="line"><span class="string">    [ 1.5000, 10.0000]])</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">tensor.grad = <span class="literal">None</span> <span class="comment"># 如果想重新算梯度，需要将梯度清零；tensor.grad = None</span></span><br><span class="line">max_out.backward()</span><br><span class="line">print(tensor.grad)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">tensor([[0., 0.],</span></span><br><span class="line"><span class="string">    [0., 8.]])</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># mean_out = 1/4 * sum(tensor*tensor)   </span></span><br><span class="line"><span class="comment"># mean_out 的梯度是d(mean_out)/d(tensor) = 1/4*2*tensor = tensor/2  </span></span><br><span class="line"><span class="comment"># max_out = max(tensor*tensor)   </span></span><br><span class="line"><span class="comment"># max_out 的梯度是d(max_out)/d(tensor) = max(2*tensor)  </span></span><br><span class="line"><span class="comment"># mean,max之类的函数不参与梯度运算，原样保留  </span></span><br><span class="line"><span class="comment"># max simply selects the greatest value and ignores the others, so max is the identity operation for that one element.   </span></span><br><span class="line"><span class="comment"># Therefore the gradient can flow backwards through it for just that one element.  </span></span><br><span class="line">  </span><br><span class="line">  </span><br></pre></td></tr></table></figure><h2 id="NN-花式求梯度"><a href="#NN-花式求梯度" class="headerlink" title="NN 花式求梯度"></a>NN 花式求梯度</h2><p>NN来自<a href="https://github.com/yunjey/pytorch-tutorial/blob/master/tutorials/01-basics/feedforward_neural_network/main.py">https://github.com/yunjey/pytorch-tutorial/blob/master/tutorials/01-basics/feedforward_neural_network/main.py</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Fully connected neural network with one hidden layer</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NeuralNet</span>(<span class="params">nn.Module</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, input_size, hidden_size, num_classes</span>):</span></span><br><span class="line">        <span class="built_in">super</span>(NeuralNet, self).__init__()</span><br><span class="line">        self.fc1 = nn.Linear(input_size, hidden_size)</span><br><span class="line">        self.relu = nn.ReLU()</span><br><span class="line">        self.fc2 = nn.Linear(hidden_size, num_classes)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">forward</span>(<span class="params">self, x</span>):</span></span><br><span class="line">        out = self.fc1(x)</span><br><span class="line">        out = self.relu(out)</span><br><span class="line">        out = self.fc2(out)</span><br><span class="line">        <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 定义一个函数用来算梯度，这里其实和forward一样，用来算输出的梯度; </span></span><br><span class="line">    <span class="comment"># 也可以改成别的，比如去掉fc2和relu，算一下第一层对输入的梯度；</span></span><br><span class="line">    <span class="comment"># 也可以指定某个神经元的梯度，比如return out[:,2]就是只用第三个神经元算梯度</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pre_grad</span>(<span class="params">self,x</span>):</span>     </span><br><span class="line">        out = self.fc1(x)</span><br><span class="line">        out = self.relu(out)</span><br><span class="line">        out = self.fc2(out)</span><br><span class="line">        <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line">model = NeuralNet(input_size, hidden_size, num_classes).to(device)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Loss and optimizer</span></span><br><span class="line">criterion = nn.CrossEntropyLoss()</span><br><span class="line">optimizer = torch.optim.Adam(model.parameters(), lr=learning_rate)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(num_epochs):</span><br><span class="line">    <span class="keyword">for</span> i, (images, labels) <span class="keyword">in</span> <span class="built_in">enumerate</span>(train_loader):</span><br><span class="line">        <span class="comment"># Move tensors to the configured device</span></span><br><span class="line">        images = images.reshape(-<span class="number">1</span>, <span class="number">28</span>*<span class="number">28</span>).to(device)</span><br><span class="line">        images.requires_grad = <span class="literal">True</span></span><br><span class="line">        labels = labels.to(device)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Forward pass</span></span><br><span class="line">        outputs = model(images)</span><br><span class="line">        loss = criterion(outputs, labels)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Backward and optimize</span></span><br><span class="line">        optimizer.zero_grad()</span><br><span class="line">        <span class="comment"># 这里计算的是loss对input的梯度; shape (100,784); loss是一个标量，不需要传参给backward()</span></span><br><span class="line">        loss.backward()</span><br><span class="line">        print(np.shape(images.grad),images.grad[<span class="number">0</span>][:<span class="number">5</span>])</span><br><span class="line">        optimizer.step()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 计算输出对输入的梯度 d(output) / d(input); shape也是(100,784)，原因参见下面backward的解析</span></span><br><span class="line">        model.zero_grad()</span><br><span class="line">        out = model.pre_grad(images)</span><br><span class="line">        <span class="comment"># 求向量对向量的梯度，需要传一个grad_tensor进去，这个grad_tensor和out的shape要一样</span></span><br><span class="line">        <span class="comment"># 这里的ones_like(out)就是产生一个和out的shape一样，元素全为1的tensor</span></span><br><span class="line">        <span class="comment"># 这个grad_tensor的物理意义是权重; </span></span><br><span class="line">        <span class="comment"># torch在算完Jacobian矩阵后，会用Jacobian矩阵乘上这个grad_tensor，对各列（即每个神经元对input所有字节的梯度）做一个加权和</span></span><br><span class="line">        <span class="comment"># 所以得到的仍然是一个shape为(100,784)的张量</span></span><br><span class="line">        out.backward(torch.ones_like(out)) </span><br><span class="line">        print(np.shape(images.grad),images.grad[<span class="number">0</span>][:<span class="number">5</span>])</span><br><span class="line">        images.grad = <span class="literal">None</span> <span class="comment"># 记得清零</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 可以参考：https://blog.csdn.net/weixin_38314865/article/details/100423919</span></span><br><span class="line">        <span class="comment"># https://mustafaghali11.medium.com/how-pytorch-backward-function-works-55669b3b7c62</span></span><br><span class="line">        <span class="comment"># https://zhuanlan.zhihu.com/p/83172023</span></span><br><span class="line">        <span class="comment"># 注意，如果input是一个batch，即使最后一层只有一个神经元，也要传grad_tensor进去</span></span><br><span class="line">        <span class="comment">#   虽然out的shape是(batch_size,), 但其实后台直接按(batch_size,1)来处理了，</span></span><br><span class="line">        <span class="comment">#   所以乘上一个ones_like(out)相当于对第二维求加权和，使得求导可以进行</span></span><br><span class="line">        <span class="comment">#   shape的变化：(batch_size,1) * (batch_size,) -&gt; (1,)；</span></span><br><span class="line">        <span class="comment">#   所以本质是用某种方法让dy/dx的y变成一个标量</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">            # 如果想要得到原始的Jacobian矩阵，需要利用one-hot向量多次backward，再把结果拼起来; 例如</span></span><br><span class="line"><span class="string">            x = torch.randn(2, requires_grad=True)</span></span><br><span class="line"><span class="string">            y = x * 2</span></span><br><span class="line"><span class="string">            J = torch.zeros(x.shape[0],x.shape[0]) # 初始化空Jacobian矩阵 (2*2)</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">            y.backward(torch.FloatTensor([[1,0]]),retain_graph=True) # 第一行</span></span><br><span class="line"><span class="string">            J[:,0] = x.grad</span></span><br><span class="line"><span class="string">            x.grad = None</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">            y.backward(torch.FloatTensor([[0,1]]),retain_graph=True) # 第二行</span></span><br><span class="line"><span class="string">            J[:,1] = x.grad</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            print(J)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            # 对于这个nn，Jacobian矩阵也可以通过修改计算图pre_grad，遍历神经元再拼起来得到</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 也可以计算对单个样本的梯度; shape (1,784)</span></span><br><span class="line">        img = images[<span class="number">0</span>].view(<span class="number">1</span>,-<span class="number">1</span>)</span><br><span class="line">        img.requires_grad = <span class="literal">True</span> <span class="comment"># 注意，计算单个样本的时候，需要把上面对整体样本的设置注视掉，即注释掉images.requires_grad = True</span></span><br><span class="line">        model.zero_grad()</span><br><span class="line">        out = model.pre_grad(img)</span><br><span class="line">        out.backward(torch.ones_like(out)) <span class="comment"># 同上，传入Jacobian矩阵加权向量</span></span><br><span class="line">        print(np.shape(img.grad),img.grad[:,:<span class="number">5</span>])</span><br><span class="line">        img.grad = <span class="literal">None</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;官方教程-Learn-PyTorch-with-Examples&quot;&gt;&lt;a href=&quot;#官方教程-Learn-PyTorch-with-Examples&quot; class=&quot;headerlink&quot; title=&quot;官方教程 Learn PyTorch with Exam</summary>
      
    
    
    
    
    <category term="AI" scheme="https://learner0x5a.github.io/tags/AI/"/>
    
  </entry>
  
  <entry>
    <title>实用网站收集</title>
    <link href="https://learner0x5a.github.io/2021/02/07/websitecollection/"/>
    <id>https://learner0x5a.github.io/2021/02/07/websitecollection/</id>
    <published>2021-02-07T03:20:45.000Z</published>
    <updated>2021-02-07T03:27:04.925Z</updated>
    
    <content type="html"><![CDATA[<h1 id="翻译"><a href="#翻译" class="headerlink" title="翻译"></a>翻译</h1><p><a href="https://www.deepl.com/translator">deepl</a></p><h1 id="IDA"><a href="#IDA" class="headerlink" title="IDA"></a>IDA</h1><p><a href="https://magiclantern.fandom.com/wiki/IDAPython">IDA Python wiki</a><br><a href="http://www.idabook.com/">IDA Book</a></p><h1 id="社工"><a href="#社工" class="headerlink" title="社工"></a>社工</h1><p><a href="https://haveibeenpwned.com/">密码撞库检查</a></p><h1 id="黑苹果"><a href="#黑苹果" class="headerlink" title="黑苹果"></a>黑苹果</h1><p><a href="http://blog.daliansky.net/">黑果小兵</a></p><h1 id="杂项"><a href="#杂项" class="headerlink" title="杂项"></a>杂项</h1><p><a href="https://godbolt.org/">Compiler Explorer</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;翻译&quot;&gt;&lt;a href=&quot;#翻译&quot; class=&quot;headerlink&quot; title=&quot;翻译&quot;&gt;&lt;/a&gt;翻译&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://www.deepl.com/translator&quot;&gt;deepl&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;IDA&quot;&gt;</summary>
      
    
    
    
    
    <category term="Tools" scheme="https://learner0x5a.github.io/tags/Tools/"/>
    
  </entry>
  
  <entry>
    <title>以孝治国：孝与家国伦理</title>
    <link href="https://learner0x5a.github.io/2021/02/01/yxzg/"/>
    <id>https://learner0x5a.github.io/2021/02/01/yxzg/</id>
    <published>2021-02-01T14:59:47.000Z</published>
    <updated>2021-02-01T15:51:59.867Z</updated>
    
    <content type="html"><![CDATA[<p>夫孝者，善继人之志，善述人之志。 —— 《礼记·中庸》</p><h1 id="孝与孝道"><a href="#孝与孝道" class="headerlink" title="孝与孝道"></a>孝与孝道</h1><p>孝是子女对父母的自然亲情。<br>殷商时代，孝是宗教性的。以崇拜，祭祀祖先为根本目的，祈求祖先神灵庇佑。</p><p>孝道是被儒学家和统治者升华，外延，扭曲，推向极端的封建伦理道德。<br>但在中国社会中二者并未截然分开。</p><p>孝具有政治外延性。移孝为忠，报效国家和民族，不仅要孝敬老人，还要尊重长辈的意愿，实现长辈的愿望，为家族，乡里，国家争得荣誉。<br>此即成为统治思想中的孝道。</p><h1 id="儒家的孝道"><a href="#儒家的孝道" class="headerlink" title="儒家的孝道"></a>儒家的孝道</h1><p>为了维护父家长传统的等级制，孔子强调“孝悌”“亲亲尊尊”。<br>孔子将孝作为人格修养的根本，外推到亲族，社会和国家政治。<br>经由历代儒学家层层加码，孝演变成为治国的伦理工具。<br>将社会政治和家庭伦理结合，把外在的等级制度内化为每个人必须具备的伦理道德意识和自觉要求。</p><p>儒家提倡不违父母之命。谏诤不从，只得服从。“三谏而不听则号泣而随之。”<br>为了“亲亲尊尊”，采用“子为父隐”掩盖事实真相，维护尊长颜面。</p><p>孔子是儒家不是法家，在儒家这里，只有礼，没有法。</p><p>古代中国人的经世观念讲究立身扬名，不辱没祖先，否则为不孝。这一观念由《三字经》贯彻到世俗社会——“扬名声，显父母”。</p><p>汉朝开始，孝道被扭曲，强化，走向极端。“举孝廉”时期，为了博取孝子的美名，正常的孝被视为平淡，必须变本加厉，超越礼制，孝出个高水平，高难度，才能引起社会和朝廷的注意。由此形成愚孝，假孝，欺世盗名，惊世骇俗。<br><em>“生不养，死厚葬。”</em></p><p>随着孝道的强化，开始强调“树欲静而风不止，子欲养而亲不待”。个人必须放弃自身价值的实现，将“尽孝”放在首位。<br>“无违”变为“父叫子亡，子不亡不孝”，“棍棒底下出孝子”。<br>是非判断的落点归于孝：人不孝敬父母，禽兽不如，天地不容。<br>孝从人情变为了天理。</p><h1 id="佛教"><a href="#佛教" class="headerlink" title="佛教"></a>佛教</h1><p>佛教视人生为苦海，要求人们四大皆空，六根清净，了却生死，超脱世俗。<br>儒家是奋力入世的哲学，让人生价值实现在今生今世。<br>佛教是消极避世的哲学，让人生价值实现在来世，不重视今生今世的人际伦理，<em>不跪王者，不敬父母</em>。</p><h1 id="以孝齐家"><a href="#以孝齐家" class="headerlink" title="以孝齐家"></a>以孝齐家</h1><p>从先秦儒家经典到程朱理学，文人政客对家庭伦理你讲五品，我说六顺，他言七教，然后又有八德，十礼，致使家庭伦理的繁文缛节层层累积，令人目不暇接。<br>《礼记·礼运篇》提出“十义”：父慈子孝，兄良弟悌，夫义妇听，长惠幼顺，君仁臣忠。</p><p>宗法社会强调父子，兄弟，夫妇，长幼双方等家庭伦理，这些建立在道德等价交换和“平等”人格的基础上。<br>三纲五常之后，家庭伦理开始失衡。弱化君仁，父慈，夫义，强调臣忠，子孝，妇听。</p><h1 id="以孝治国"><a href="#以孝治国" class="headerlink" title="以孝治国"></a>以孝治国</h1><p>历代王朝通过“官”统治人们，美其名曰“民之父母”，把被统治者亲切地称之为“子民”，把统治者称为“父母官”。<br>被统治者需要像儿子对待父亲一样对待父母官和君父。</p><p>对君父和父母官对崇拜和拥戴，使得农民把实现和谐生活对幻想寄托在有道明君和青天大老爷身上。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;夫孝者，善继人之志，善述人之志。 —— 《礼记·中庸》&lt;/p&gt;
&lt;h1 id=&quot;孝与孝道&quot;&gt;&lt;a href=&quot;#孝与孝道&quot; class=&quot;headerlink&quot; title=&quot;孝与孝道&quot;&gt;&lt;/a&gt;孝与孝道&lt;/h1&gt;&lt;p&gt;孝是子女对父母的自然亲情。&lt;br&gt;殷商时代，孝是宗教性</summary>
      
    
    
    
    
    <category term="BookReading" scheme="https://learner0x5a.github.io/tags/BookReading/"/>
    
  </entry>
  
  <entry>
    <title>IDA Linux 配置</title>
    <link href="https://learner0x5a.github.io/2021/01/18/IDALinux/"/>
    <id>https://learner0x5a.github.io/2021/01/18/IDALinux/</id>
    <published>2021-01-18T14:42:07.000Z</published>
    <updated>2021-01-25T15:33:06.696Z</updated>
    
    <content type="html"><![CDATA[<h1 id="IDA-Linux-Conf"><a href="#IDA-Linux-Conf" class="headerlink" title="IDA-Linux-Conf"></a>IDA-Linux-Conf</h1><p>Configure IDA pro linux version to support custom python/pip. 配置linux版IDA，支持自己的python/pip。</p><p>Tested with IDA pro 6.8 on Ubuntu 18.04 64bit.</p><h2 id="32位环境配置；32bit-enviroment"><a href="#32位环境配置；32bit-enviroment" class="headerlink" title="32位环境配置；32bit enviroment"></a>32位环境配置；32bit enviroment</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dpkg --add-architecture i386</span><br><span class="line">apt update</span><br><span class="line">apt dist-upgrade</span><br><span class="line">apt install gcc-multilib g++-multilib dialog apt-utils</span><br><span class="line">apt install lib32ncurses5 lib32z1</span><br><span class="line">apt install lib32stdc++6 build-essential libssl-dev libffi-dev python-dev libssl-dev libgcc1:i386 zlib1g:i386</span><br></pre></td></tr></table></figure><h2 id="使用自己的python-pip；Use-custom-python-pip"><a href="#使用自己的python-pip；Use-custom-python-pip" class="headerlink" title="使用自己的python/pip；Use custom python/pip"></a>使用自己的python/pip；Use custom python/pip</h2><p>linux版本的ida pro自带的python是没有binary的，只有一个libpython.so.1.0，没有pip，不能安装第三方的模块比如capstone。</p><p>网上的解决方法（Solutions from internet）：</p><ul><li><p>没看懂的操作，但对现有方法做了<a href="https://duksctf.github.io/2017/03/15/Make-IDA-Pro-Great-Again.html">汇总</a>；A summary</p></li><li><p><a href="https://github.com/zardus/idalink">idalink</a>：看起来很好用，但要求ida版本&gt;7.0；Require IDA version &gt; 7.0</p></li></ul><ul><li><p><a href="https://pythonhosted.org/arybo/integration.html">Arybo</a>：用rpc重定向至64位的python；Redirect to 64bit python with rpc</p></li><li><p>官方<a href="https://www.hex-rays.com/blog/installing-pip-packages-and-using-them-from-ida-on-a-64-bit-machine/">博客</a>：太老了；Official solution, maybe too old.</p></li></ul><h3 id="编译一个32位的python2-7；Compile-a-32-bit-python2-7"><a href="#编译一个32位的python2-7；Compile-a-32-bit-python2-7" class="headerlink" title="编译一个32位的python2.7；Compile a 32-bit python2.7"></a>编译一个32位的python2.7；Compile a 32-bit python2.7</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">apt install zlib1g-dev:i386 libsqlite3-dev:i386 libssl-dev:i386 libreadline-dev:i386 libncurses5-dev:i386 libffi-dev:i386 libbz2-dev:i386 libgcc1:i386 zlib1g:i386 libc6-dev-i386</span><br><span class="line">wget https://www.python.org/ftp/python/2.7.18/Python-2.7.18.tar.xz</span><br><span class="line">tar xvf Python-2.7.18.tar.xz</span><br><span class="line"><span class="built_in">cd</span> Python-2.7.18</span><br><span class="line">CFLAGS=-m32 LDFLAGS=-m32 ./configure --prefix=/path/to/python27-32 --with-system-ffi --with-ensurepip=install</span><br><span class="line">make -j24</span><br></pre></td></tr></table></figure><p>可能有部分模块不能编译；There can be some modules that cannot be built</p><p>没有Failed to build these modules即可。But we only need to make sure there’s no compilation failure, i.e. Failed to build these modules.</p><p>Finally, <code>make install</code></p><h3 id="使用编译得到的pip安装想要的包；Use-compiled-python-pip-to-install-whatever-you-want"><a href="#使用编译得到的pip安装想要的包；Use-compiled-python-pip-to-install-whatever-you-want" class="headerlink" title="使用编译得到的pip安装想要的包；Use compiled python-pip to install whatever you want"></a>使用编译得到的pip安装想要的包；Use compiled python-pip to install whatever you want</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> CFLAGS=-m32</span><br><span class="line"><span class="built_in">export</span> LDFLAGS=-m32</span><br><span class="line"><span class="built_in">export</span> LD_LIBRARY_PATH=/lib/i386-linux-gnu/:/usr/lib32:<span class="variable">$LD_LIBRARY_PATH</span></span><br><span class="line">/path/to/python27-32/bin/pip install &lt;package&gt;</span><br></pre></td></tr></table></figure><h3 id="使用安装的包；Use-installed-packages"><a href="#使用安装的包；Use-installed-packages" class="headerlink" title="使用安装的包；Use installed packages"></a>使用安装的包；Use installed packages</h3><p>在你脚本里添加；In your python script, add</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sys.path.append(<span class="string">&quot;/path/to/python27-32/lib/python2.7/site-packages&quot;</span>) </span><br><span class="line">sys.path.append(<span class="string">&quot;/path/to/python27-32&quot;</span>) </span><br><span class="line">sys.path.append(<span class="string">&quot;/path/to/python27-32&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="Bug-code-for-hash-md5-was-not-found"><a href="#Bug-code-for-hash-md5-was-not-found" class="headerlink" title="Bug: code for hash md5 was not found"></a>Bug: code for hash md5 was not found</h2><p>ldd查看IDA PRO自带的Python2.7 lib中_hashlib.so，提示缺少libssl.so.0.9.8 libcrypto.so.0.9.8 libpython2.7.so.1.0。</p><p>其中libpython2.7.so.1.0在IDA PRO安装目录下，将其拷贝至对应库目录下即可。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp &#x2F;path&#x2F;to&#x2F;ida&#x2F;libpython2.7.so.1.0 &#x2F;path&#x2F;to&#x2F;ida&#x2F;python&#x2F;lib&#x2F;python2.7&#x2F;lib-dynload&#x2F;</span><br></pre></td></tr></table></figure><p>IDA PRO 6.8自带的python2.7要求openssl版本为32bit 0.9.8，并且openssl1.0.0和0.9.8不兼容，所以不能通过创建软链接的方式解决，需要安装openssl0.9.8版本。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># https://mirrors.tuna.tsinghua.edu.cn/ubuntu/pool/universe/o/openssl098/libssl0.9.8_0.9.8o-7ubuntu3.2_i386.deb</span></span><br><span class="line">wget http://snapshot.debian.org/archive/debian/20110406T213352Z/pool/main/o/openssl098/libssl0.9.8_0.9.8o-7_i386.deb</span><br><span class="line">dpkg -i install libssl0.9.8_0.9.8o-7_i386.deb</span><br></pre></td></tr></table></figure><h2 id="Bug-TVision-error-Can-not-load-libcurses-so-Without-libcurses-can-work-only-with-xterm-linux"><a href="#Bug-TVision-error-Can-not-load-libcurses-so-Without-libcurses-can-work-only-with-xterm-linux" class="headerlink" title="Bug: TVision error: Can not load libcurses.so Without libcurses can work only with xterm/linux"></a>Bug: TVision error: Can not load libcurses.so Without libcurses can work only with xterm/linux</h2><p>设置环境变量</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> TERM=xterm</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;IDA-Linux-Conf&quot;&gt;&lt;a href=&quot;#IDA-Linux-Conf&quot; class=&quot;headerlink&quot; title=&quot;IDA-Linux-Conf&quot;&gt;&lt;/a&gt;IDA-Linux-Conf&lt;/h1&gt;&lt;p&gt;Configure IDA pro linu</summary>
      
    
    
    
    
    <category term="Security" scheme="https://learner0x5a.github.io/tags/Security/"/>
    
    <category term="Tools" scheme="https://learner0x5a.github.io/tags/Tools/"/>
    
  </entry>
  
  <entry>
    <title>监视资本主义:智能陷阱</title>
    <link href="https://learner0x5a.github.io/2021/01/11/Social-Dilemma/"/>
    <id>https://learner0x5a.github.io/2021/01/11/Social-Dilemma/</id>
    <published>2021-01-11T07:05:17.000Z</published>
    <updated>2021-01-11T07:08:10.424Z</updated>
    
    <content type="html"><![CDATA[<p>网飞纪录片： Social Dilemma</p><h1 id="社交媒体的正反馈"><a href="#社交媒体的正反馈" class="headerlink" title="社交媒体的正反馈"></a>社交媒体的正反馈</h1><p>每次上/下拉刷新都是新东西。你不知道什么时候能刷到自己喜欢的东西，也不知道自己能刷到什么，就像老虎机一样。<br>如今注意力经济中的这种劝服性设计在人脑中植入无意识的习惯，对人进行重编程。你的判断力，对自我价值和身份的认知都在被重新编程。<br>在意别人的看法是必要的，但我们需要在意互联网上的10000个人的看法吗？我们真的需要每隔五分钟获得一次社交认可吗？<br>我们通过获得的满足感来管理自己的生活，每次点赞、爱心、大拇指这些信号给我们短期积极的反馈。所以社交媒体将这些和价值融合，和真相融合，后果是显而易见的。<br>而个人在一次次短期反馈之后，就会想“我接下来要做什么，我还想要这种感觉”，这就是恶性循环。</p><p>设计者会想方设法占用人的时间，比如消息提醒不交代清楚什么信息，“对方正在输入…”让你保持等待。而随着AI的发展，这些设计已经不是人类在做，而是算法在做。</p><p>社交媒体不是纯粹的工具，社交媒体有其目的：占用你的时间，以从广告商、政客等处收费盈利，而其采用的手段则是利用你的心理对付你自己。</p><p>楚门为什么没有发现所在世界的真实本质？因为我们接受了呈现在我们面前的世界就是现实。</p><p>我们创造了一个虚假消息的体系，虚假信息比真实信息更能让公司盈利，因为真相是无聊的。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;网飞纪录片： Social Dilemma&lt;/p&gt;
&lt;h1 id=&quot;社交媒体的正反馈&quot;&gt;&lt;a href=&quot;#社交媒体的正反馈&quot; class=&quot;headerlink&quot; title=&quot;社交媒体的正反馈&quot;&gt;&lt;/a&gt;社交媒体的正反馈&lt;/h1&gt;&lt;p&gt;每次上/下拉刷新都是新东西。你不知</summary>
      
    
    
    
    
    <category term="others" scheme="https://learner0x5a.github.io/tags/others/"/>
    
  </entry>
  
  <entry>
    <title>西方政治思想史读书笔记</title>
    <link href="https://learner0x5a.github.io/2021/01/11/HistoryOfWesternPoliticalThoughts/"/>
    <id>https://learner0x5a.github.io/2021/01/11/HistoryOfWesternPoliticalThoughts/</id>
    <published>2021-01-10T16:39:41.000Z</published>
    <updated>2021-02-02T07:59:53.625Z</updated>
    
    <content type="html"><![CDATA[<h1 id="政治：众人之事"><a href="#政治：众人之事" class="headerlink" title="政治：众人之事"></a>政治：众人之事</h1><p>人与政治不可能完全隔绝，公共政策会影响日常生活，政治体制改革会影响一代人的命运。</p><p>以共和的视角来看，一个合格的公民应随时准备为政治世界的建设做贡献，由旁观者/思考者变为参与者。政治素养在实践中造就。</p><h1 id="古希腊：政治之始"><a href="#古希腊：政治之始" class="headerlink" title="古希腊：政治之始"></a>古希腊：政治之始</h1><h2 id="斯巴达"><a href="#斯巴达" class="headerlink" title="斯巴达"></a>斯巴达</h2><p>立法家莱库古改革：</p><pre><code>1. 设立元老院2. 均分土地与奴隶3. 取消商品交换，采用供给制4. 优生优育5. ......</code></pre><p><strong>想到了什么？</strong></p><h2 id="雅典"><a href="#雅典" class="headerlink" title="雅典"></a>雅典</h2><p>王政 -&gt; 贵族政治 -&gt; 僭主政治 -&gt; 民主政治 </p><p>僭主：武力夺取权力，没有经过合法程序。</p><h3 id="伯里克利演说"><a href="#伯里克利演说" class="headerlink" title="伯里克利演说"></a>伯里克利演说</h3><p><strong><em>我们爱好美丽的东西，但是不至于奢侈；我们爱好智慧，但不至于优柔。</em></strong></p><p><strong><em>财富是可以利用的东西，不是用来夸耀的东西。</em></strong></p><p><strong><em>他人的勇敢是因为无知，真正勇敢的人，是那个了解人生的幸福和灾难，然后勇往直前，担当起将来会发生的事故的人。</em></strong></p><p>在追求美的道路上，也会遇到最肮脏的恶。我预见了所有悲伤，但我欣然前往。</p><p><strong><em>他们贡献了他们的生命给城邦和我们所有人，至于他们自己，他们获得了永远长青的赞美和光辉灿烂的坟墓。</em></strong></p><p>《夜航星》的歌词也写得很好，“我是星，我愿投身前途未卜的群星，为梦长明，让希望做我无声永存的墓志铭。”</p><h3 id="苏格拉底"><a href="#苏格拉底" class="headerlink" title="苏格拉底"></a>苏格拉底</h3><p>以提问的方式鼓励他人思考，“我唯一知道的，是自己的无知。”</p><p>美德即知识。只有知道了什么是善，才能避免作恶。</p><h3 id="柏拉图"><a href="#柏拉图" class="headerlink" title="柏拉图"></a>柏拉图</h3><p>柏拉图要探求政治的理性基础。理想的城邦体现了绝对的善，是按理性的原则组织起来的，其基础是社会分工。<br>最好的城邦，不是抹平人与人之间的差异，而是在差异的基础上实现最优分工。</p><p>理想的国家以神话和宗教为基础。知识不能及之处，由宗教来补充。<br>神话和宗教是“高贵的谎言”，哲学家必须说谎以维持统治。</p><p>常人为“意见”所俘获，一生如在梦中，唯有哲学家是真理的代言人。<br>“意见”纷纭，“真理”只有一个。此即所谓“哲人王”。</p><p>“哲人王”是反民主的：意见之争，广场辩论应该让位于哲学家的真理之治。<br>但民主社会的问题就是，无人愿意承认谁是权威。</p><p>将政治问题转为教育问题，认为我们面临的公共危机根源在于个体的素质低下，是错误的。<br>政权更替，王朝兴衰并不意味着人民素质的突飞猛进。<br>诉诸人的培养以应对现实世界的问题，是教育救国的乌托邦，而教育也会沦为支配工具。</p><h3 id="不以物喜，不以己悲？"><a href="#不以物喜，不以己悲？" class="headerlink" title="不以物喜，不以己悲？"></a>不以物喜，不以己悲？</h3><p>人必然会受人生经历的局限，即便思想是自由的，也仍然会有浓重的时代烙印。<br>我们提倡独立思考，这主要是针对人云亦云/盲从权威的说法。<br>我们穷尽一生，都只是在以不同的方式回应时代的问题。</p><h3 id="亚里士多德"><a href="#亚里士多德" class="headerlink" title="亚里士多德"></a>亚里士多德</h3><p><strong>“人是天生的政治动物”</strong></p><p>城邦是一种为了实现共同的善而形成的结合体，城邦不仅是为了满足基本生活的需要，还要进一步追求一种美好的，高贵的生活。<br>政治关系是一种特定的平等自由的合作关系，既不是柏拉图所说统治者与被统治者的关系，也不是家庭中主人与奴隶的关系。<br>城邦的本质是政治自由与专业技能的结合。</p><p>然而探究什么是好的城邦，比较政体的优劣，只是服从于如何实现人的完善这一根本性的任务。<br>亚里士多德将生活分为享乐的生活，政治的生活和沉思的生活。三种都有其合理性，但沉思的生活是最幸福的，是理性充分活跃的。<br>沉思的生活追求至真，至善，至美。<br>沉思让人感到快乐，这种快乐纯粹，持久且自足，无需他人帮助。<br>沉思是无功利的，除了所沉思的问题之外不产生任何东西，不像在实践中，人们总在寻求得到什么。</p><p>但是，沉思的生活要求人们从城邦生活中退出，意味着放弃公民责任，对城邦造成毁灭性打击。</p><h2 id="希腊化时期"><a href="#希腊化时期" class="headerlink" title="希腊化时期"></a>希腊化时期</h2><h3 id="犬儒学派"><a href="#犬儒学派" class="headerlink" title="犬儒学派"></a>犬儒学派</h3><p>犬儒学派追求顺从天性，返璞归真。追求精神上的自主，不在乎别人的议论，要求个人与习俗决裂，与世界对抗。</p><p>犬儒学派同时也最早提出了“世界公民”的概念。真正的城邦只有一个，那就是宇宙。</p><h3 id="斯多葛学派"><a href="#斯多葛学派" class="headerlink" title="斯多葛学派"></a>斯多葛学派</h3><p>斯多葛学派强调理性的运用。人要学会控制自己的感情和欲望，存天理灭人欲，远离爱恨情仇，做一个圣人。<br>圣人最富有，最自由，是王者，是不死的神。</p><p>自然法：法律根植于自然，法律是一种自然力，是聪明人的理性，是衡量正义与否的标准。</p><p>斯多葛学派的思想类似于焦虑时代的心灵鸡汤。<br>“我们不能有福，但可以有善。只要我们有善，就让我们装成对不幸不计较。这种学说在一个恶劣的世界里是有用的，但却不是真实的。” —— 罗素</p><h3 id="伊壁鸠鲁学派"><a href="#伊壁鸠鲁学派" class="headerlink" title="伊壁鸠鲁学派"></a>伊壁鸠鲁学派</h3><p>伊壁鸠鲁学派提出了社会契约论。社会并非自然演化而成，而是建立在防止互相伤害的契约的基础上。<br>法律是用来提醒和惩戒一些不谨慎的人的，有良好的判断力的人无需法律。<br>这在古希腊时代是无神论。</p><h3 id="怀疑主义"><a href="#怀疑主义" class="headerlink" title="怀疑主义"></a>怀疑主义</h3><p>怀疑主义否定了人类获取绝对知识的可能性。正反两方面的道理都正确。<br>亚里士多德，斯多葛学派，伊壁鸠鲁学派都认为自己找到的通向真理的道路，而怀疑论者不相信自然法，不相信普遍道德准则的存在，一切法律都是人为创造出来的。<br>怀疑主义者不信任何教义，只寻求自我内在的平静。他们可以在任何习俗和法律中“幸福生活”。</p><p>古希腊哲学终止于怀疑主义。个人追求幸福是徒劳的，因为我们不知道何为幸福， 如何求得幸福。<br>哲学对真理的追求，探询，并不能导向某种确定的幸福生活。</p><p><em>古希腊人试图追求理性，追寻本质，最终却走向了怀疑主义。</em></p><h1 id="古罗马"><a href="#古罗马" class="headerlink" title="古罗马"></a>古罗马</h1><h2 id="共和"><a href="#共和" class="headerlink" title="共和"></a>共和</h2><p>罗马为何强大？<br>Πολυβιθσ(Polybius)说，纯粹的君主制/贵族制/民主制都容易腐化，隐含了权力使人腐化，绝对权力使人绝对腐化的观点。<br>最初君主凭其才德创建政体，但之后沦为僭主，贵族便联手将其推翻，确立贵族政体。<br>但是贵族们经过几代人之后，其不肖子孙骄奢淫逸，沦为寡头，激起人民的反抗。<br>人民建立民主政体，经过几代，自由平等不再受重视，人民挥霍享乐，任由野心家煽动，于是强人出现，又恢复了君主制。</p><p>单一的政体如此往复交替，而罗马人建立了由执政官/元老院/平民大会三种要素组成的政体，三者相互制约平衡。<br>罗马的混合政体影响深远，现代英美的政体都是典型的混合政体。<br>英国：国王，上议院，下议院；美国：总统，参议院，众议院。<br>一如罗马，分别对应君主/贵族/人民。</p><h2 id="帝国"><a href="#帝国" class="headerlink" title="帝国"></a>帝国</h2><p>共和晚期，统治精英素质衰退，元老不再是资深政治家，而是因为父辈进入元老院。<br>随着条顿人的入侵，罗马从亦农亦兵转为建立职业化军队，军人从效忠共和转为效忠统帅。<br>经由庞培，凯撒，奥古斯都，罗马从共和转为帝制。</p><p>由于人民的腐化，美德的丧失，共和时代一去不复返了。<br>知识分子不再讨论共和，而是在帝制前提下讨论政治，讨论一个合格的君主要有什么美德。<br>这与中华帝国儒家知识分子好谈君王有道无道，圣明昏聩，而不思考政体本身十分相似。<br>严格来说，这便只有伦理学而没有政治学，对当权者的道德说教毫无用处。<br>如同儒家的圣王理性，这种说教唤起了受奴役的人民心中对圣王的想象，原本对君王的道德训诫，成了王权的道德外衣。<br>人民之所以要服从君主，是因为君主在理性和道德上是完美的。</p><p>为了证明帝制中的人民拥有自由，建立在斯多葛学派自然法之上的罗马自有一套说法。<br>我们感到不自由不幸福，是因为我们错误地定义了自由和幸福。<br>我们总是从身外之物看待一切，而关键其实是内心的自由与幸福。<br>所有的灾难都是对美德的训练，人不应该去思考改变政体，改变外在的境遇，而是要着眼于自我道德的修炼。<br>这种观点，有时是一种自欺欺人。</p><h2 id="青山遮不住，毕竟东流去。"><a href="#青山遮不住，毕竟东流去。" class="headerlink" title="青山遮不住，毕竟东流去。"></a>青山遮不住，毕竟东流去。</h2><p>理解古典西方文明，需要把握其三个特点：城市文明，沿海文明，奴隶文明。<br>第三点对于理解古典西方文明的衰落十分重要。奴隶是经济的基础，当罗马帝国放弃扩张的帝国政策，奴隶主只能允许奴隶组建家庭实现奴隶的再生产。<br>由奴隶贸易支撑的商品经济转为以物易物的自然经济。而西方人称之为“黑暗的中世纪”。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;政治：众人之事&quot;&gt;&lt;a href=&quot;#政治：众人之事&quot; class=&quot;headerlink&quot; title=&quot;政治：众人之事&quot;&gt;&lt;/a&gt;政治：众人之事&lt;/h1&gt;&lt;p&gt;人与政治不可能完全隔绝，公共政策会影响日常生活，政治体制改革会影响一代人的命运。&lt;/p&gt;
&lt;p&gt;以共</summary>
      
    
    
    
    
    <category term="BookReading" scheme="https://learner0x5a.github.io/tags/BookReading/"/>
    
  </entry>
  
  <entry>
    <title>Linux 手动引导</title>
    <link href="https://learner0x5a.github.io/2021/01/09/linuxBoot/"/>
    <id>https://learner0x5a.github.io/2021/01/09/linuxBoot/</id>
    <published>2021-01-09T12:56:37.000Z</published>
    <updated>2021-01-09T13:08:08.547Z</updated>
    
    <content type="html"><![CDATA[<p>服务器断电后重启，引导出错，需要手动引导进入系统。</p><h1 id="Linux启动流程"><a href="#Linux启动流程" class="headerlink" title="Linux启动流程"></a>Linux启动流程</h1><ol><li>BIOS程序</li><li>GRUB引导</li><li>内核引导</li><li>调用虚拟文件系统initrd<ul><li>加载驱动</li><li>加载真正的根文件系统</li><li>执行/sbin/init</li><li>系统初始化</li></ul></li><li>启动终端</li></ol><h1 id="GRUB手动引导内核"><a href="#GRUB手动引导内核" class="headerlink" title="GRUB手动引导内核"></a>GRUB手动引导内核</h1><p>在grub shell中ls查看硬盘分区情况，常见的分区方案是，对于硬盘sdx，sdx1为boot分区(/boot)，sdx2为swap分区([SWAP])，sdx3为根分区(/)。</p><p>逐个尝试ls (hdx, y)/boot/grub，找到根文件系统所在分区（通常y=gpt3），也可以ls (hdx, y)查看该分区下所有文件。</p><p>如果手上有LiveCD，可以进LiveCD看一下分区情况。</p><p>所以该机器的引导参数如下:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 指定根文件系统</span></span><br><span class="line">$ root=(hd3,gpt3)</span><br><span class="line"><span class="comment"># 指定内核</span></span><br><span class="line">$ linux /boot/vmlinuz[Tab补全] root=/dev/sdb3</span><br><span class="line"><span class="comment"># 指定虚拟文件系统</span></span><br><span class="line">$ initrd /boot/initrd[Tab补全].img</span><br><span class="line"><span class="comment"># 启动</span></span><br><span class="line">$ boot</span><br></pre></td></tr></table></figure><p>tab补全时，虽然有四个内核可选，但有两个加载失败，最后加载5.3.0-62及对应的initrd，引导成功。</p><h1 id="从U盘进入Livecd，查看文件系统-磁盘状态"><a href="#从U盘进入Livecd，查看文件系统-磁盘状态" class="headerlink" title="从U盘进入Livecd，查看文件系统/磁盘状态"></a>从U盘进入Livecd，查看文件系统/磁盘状态</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df -h <span class="comment"># 查看已挂载的磁盘分区及挂载点</span></span><br><span class="line">fdisk -l <span class="comment"># 查看磁盘分区，包括未挂载的磁盘</span></span><br><span class="line">lsblk -l <span class="comment"># 查看磁盘分区，包括未挂载的磁盘</span></span><br></pre></td></tr></table></figure><p>可以发现，当前boot在sdd，挂载点是/cdrom，即sdd是U盘上livecd的系统。</p><p>查看另外的磁盘，找到EFI分区和swap分区所在的磁盘，比如sdb，说明原来的系统在sdb上。</p><p>根文件系统在Type:Linux所在的分区，例如/dev/sdb3，对应到grub里面，应该是某块硬盘的第三个分区，例如(hd3,gpt3)。</p><p><strong>注意：USB的插入会影响grub中硬盘的编号，同一块硬盘有时候是hd3，有时候是hd4</strong></p><h1 id="如何判断文件系统是否需要修复？"><a href="#如何判断文件系统是否需要修复？" class="headerlink" title="如何判断文件系统是否需要修复？"></a>如何判断文件系统是否需要修复？</h1><p>一般情况下，linux系统启动阶段，如果文件系统出现了crash，会提示有orphan node，无法正常启动。此时，需要使用fsck来修复文件系统。一般来说，异常断电就可能出现这种情况。</p><p>异常断电情况下，需要手动按照之前记录的挂载目录参数来手动进行引导。如果手动引导仍然无法成功，大概率是文件系统挂了，此时需要先修复文件系统，再进入grub中手动引导。</p><p>grub启动引导记录的修复（通过boot-repair修复后，再手动检查grub启动引导配置文件是否无误），可以保证正常重启服务器是没问题的。</p><p>但是通常异常断电的情况下，grub引导又会出错从而导致系统无法正常被引导启动。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;服务器断电后重启，引导出错，需要手动引导进入系统。&lt;/p&gt;
&lt;h1 id=&quot;Linux启动流程&quot;&gt;&lt;a href=&quot;#Linux启动流程&quot; class=&quot;headerlink&quot; title=&quot;Linux启动流程&quot;&gt;&lt;/a&gt;Linux启动流程&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;BIO</summary>
      
    
    
    
    
    <category term="others" scheme="https://learner0x5a.github.io/tags/others/"/>
    
  </entry>
  
  <entry>
    <title>Win10激活-自建KMS服务器</title>
    <link href="https://learner0x5a.github.io/2021/01/08/kms/"/>
    <id>https://learner0x5a.github.io/2021/01/08/kms/</id>
    <published>2021-01-08T07:59:30.000Z</published>
    <updated>2021-01-08T08:18:44.377Z</updated>
    
    <content type="html"><![CDATA[<h1 id="KMS-server-docker"><a href="#KMS-server-docker" class="headerlink" title="KMS server - docker"></a>KMS server - docker</h1><p><a href="https://github.com/Wind4/vlmcsd-docker">vlmcsd</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/Wind4/vlmcsd-docker.git vlmcsd</span><br><span class="line"><span class="built_in">cd</span> vlmcsd</span><br><span class="line"><span class="comment"># Use docker-compose service</span></span><br><span class="line">docker-compose up -d</span><br><span class="line"><span class="comment"># or docker build image</span></span><br><span class="line"><span class="comment"># docker build -t vlmcsd .</span></span><br><span class="line"><span class="comment"># docker run -idt -p 1688:1688 vlmcsd</span></span><br></pre></td></tr></table></figure><h1 id="KMS-client-Windows-10"><a href="#KMS-client-Windows-10" class="headerlink" title="KMS client - Windows 10"></a>KMS client - Windows 10</h1><ol><li><p>管理员权限运行cmd，卸载之前的key：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">slmgr.vbs -upk</span><br></pre></td></tr></table></figure></li><li><p>安装kms客户端key（去<a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/jj612867(v=ws.11)">官网</a>找自己版本的key，这里是教育版的key）：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">slmgr.vbs -ipk NW6C2-QMPVW-D7KKK-3GKT6-VCFB2</span><br></pre></td></tr></table></figure></li><li><p>设置kms服务器，ip:port换成上面kms server docker的ip:port，默认端口是1688</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">slmgr.vbs -skms 1.2.3.4:6666</span><br></pre></td></tr></table></figure></li><li><p>连线激活(稍等一会)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">slmgr.vbs -ato</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;KMS-server-docker&quot;&gt;&lt;a href=&quot;#KMS-server-docker&quot; class=&quot;headerlink&quot; title=&quot;KMS server - docker&quot;&gt;&lt;/a&gt;KMS server - docker&lt;/h1&gt;&lt;p&gt;&lt;a hre</summary>
      
    
    
    
    
    <category term="others" scheme="https://learner0x5a.github.io/tags/others/"/>
    
  </entry>
  
  <entry>
    <title>本地文件丢失，如何恢复hexo博客</title>
    <link href="https://learner0x5a.github.io/2021/01/06/restore/"/>
    <id>https://learner0x5a.github.io/2021/01/06/restore/</id>
    <published>2021-01-06T12:45:16.000Z</published>
    <updated>2021-01-06T12:45:49.240Z</updated>
    
    <content type="html"><![CDATA[<h2 id="恢复hexo"><a href="#恢复hexo" class="headerlink" title="恢复hexo"></a>恢复hexo</h2><h3 id="重新init"><a href="#重新init" class="headerlink" title="重新init"></a>重新init</h3><p>hexo之前push到git上的只有生成的html/图片，没有md文件。</p><p>如何恢复？</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install html2text</span><br></pre></td></tr></table></figure><p>把html转为文本，再手动重建md。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;恢复hexo&quot;&gt;&lt;a href=&quot;#恢复hexo&quot; class=&quot;headerlink&quot; title=&quot;恢复hexo&quot;&gt;&lt;/a&gt;恢复hexo&lt;/h2&gt;&lt;h3 id=&quot;重新init&quot;&gt;&lt;a href=&quot;#重新init&quot; class=&quot;headerlink&quot; titl</summary>
      
    
    
    
    
    <category term="others" scheme="https://learner0x5a.github.io/tags/others/"/>
    
  </entry>
  
  <entry>
    <title>树莓派4b</title>
    <link href="https://learner0x5a.github.io/2020/12/24/rpi/"/>
    <id>https://learner0x5a.github.io/2020/12/24/rpi/</id>
    <published>2020-12-24T12:16:39.000Z</published>
    <updated>2021-01-06T09:15:42.276Z</updated>
    
    <content type="html"><![CDATA[<h1 id="树莓派4b折腾笔记"><a href="#树莓派4b折腾笔记" class="headerlink" title="树莓派4b折腾笔记"></a>树莓派4b折腾笔记</h1><h2 id="硬件"><a href="#硬件" class="headerlink" title="硬件"></a>硬件</h2><p>如果OS运行在TF卡上，一定要用高速TF卡，我选用的是SanDisk Extreme PRO 32 GB。</p><h2 id="装系统"><a href="#装系统" class="headerlink" title="装系统"></a><a href="https://ubuntu.com/tutorials/how-to-install-ubuntu-desktop-on-raspberry-pi-4#2-prepare-the-sd-card">装系统</a></h2><p>装完系统先给LAN<a href="https://www.cnblogs.com/blueyunchao0618/p/11394640.html">配个静态ip</a></p><p>考虑到图形界面的开销很大，我装了一个Ubuntu server 20.04，TF卡镜像写完开机即用，无需安装系统。</p><p>同时由于没有图形界面，需要连Wifi的话：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ip link <span class="comment"># 查看各个网卡状态</span></span><br><span class="line">sudo iw dev wlan0 scan | grep SSID <span class="comment"># 扫描附近的SSID</span></span><br><span class="line">wpa_passphrase <span class="string">&quot;&lt;SSID&gt;&quot;</span> <span class="string">&quot;&lt;Password&gt;&quot;</span> <span class="comment"># 输出配置模板到stdout</span></span><br><span class="line">sudo vim /etc/wpa_supplicant/wpa_supplicant.conf <span class="comment"># 按上述模板配置WiFi</span></span><br><span class="line">sudo wpa_supplicant -B -D nl80211 -i wlan0 -c /etc/wpa_supplicant/wpa_supplicant.conf <span class="comment"># 连接Wi-Fi</span></span><br></pre></td></tr></table></figure><h2 id="软件源"><a href="#软件源" class="headerlink" title="软件源"></a>软件源</h2><p><code>uname -a</code>看一眼架构为<code>aarch64</code>属于arm64架构，选用<a href="https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu-ports/">Ubuntu-ports源</a></p><h2 id="尝试作为服务器"><a href="#尝试作为服务器" class="headerlink" title="尝试作为服务器"></a>尝试作为服务器</h2><p>连接到华为随行wifi3之后，即使配了端口转发也无法连接。</p><p>查看wifi的wan口ip发现是个10.x.x.x的局域网ip，为什么？也许就是因为这个？</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;树莓派4b折腾笔记&quot;&gt;&lt;a href=&quot;#树莓派4b折腾笔记&quot; class=&quot;headerlink&quot; title=&quot;树莓派4b折腾笔记&quot;&gt;&lt;/a&gt;树莓派4b折腾笔记&lt;/h1&gt;&lt;h2 id=&quot;硬件&quot;&gt;&lt;a href=&quot;#硬件&quot; class=&quot;headerlink&quot; </summary>
      
    
    
    
    
    <category term="OS" scheme="https://learner0x5a.github.io/tags/OS/"/>
    
  </entry>
  
  <entry>
    <title>基于源代码的机器学习</title>
    <link href="https://learner0x5a.github.io/2020/12/14/MLonSrcCode/"/>
    <id>https://learner0x5a.github.io/2020/12/14/MLonSrcCode/</id>
    <published>2020-12-14T11:57:03.000Z</published>
    <updated>2020-12-14T11:58:19.094Z</updated>
    
    <content type="html"><![CDATA[<h1 id="基于源代码的机器学习"><a href="#基于源代码的机器学习" class="headerlink" title="基于源代码的机器学习"></a>基于源代码的机器学习</h1><h2 id="ML4CODE"><a href="#ML4CODE" class="headerlink" title="ML4CODE"></a><a href="https://ml4code.github.io/">ML4CODE</a></h2><p>本领域主要关注三方面问题：</p><pre><code>  * 代码生成  * 代码表示  * 模式识别</code></pre><h2 id="CodRep"><a href="#CodRep" class="headerlink" title="CodRep"></a><a href="https://github.com/KTH/CodRep-competition">CodRep</a></h2><p>代码表示学习的比赛，给定源代码，要求修补源代码中的bug</p><h2 id="论文"><a href="#论文" class="headerlink" title="论文"></a>论文</h2><h3 id="程序生成"><a href="#程序生成" class="headerlink" title="程序生成"></a>程序生成</h3><p>Synthetic Datasets for Neural Program Synthesis, ICLR 2019<br>Execution-Guided Neural Program Synthesis, ICLR 2019<br>DeepFuzz: Automatic Generation of Syntax Valid C Programs for Fuzz Testing,<br>AAAI 2019<br>Towards Synthesizing Complex Programs from Input-Output Examples, ICLR 2018</p><h3 id="源代码分析及语言模型"><a href="#源代码分析及语言模型" class="headerlink" title="源代码分析及语言模型"></a>源代码分析及语言模型</h3><p>Generative Code Modeling with Graphs, ICLR 2019<br>NL2Type: Inferring JavaScript Function Types from Natural Language<br>Information, ICSE 2019<br>A Novel Neural Source Code Representation based on Abstract Syntax Tree, ICSE<br>2019<br>Deep Learning Type Inference, FSE 2018<br>Learning to Represent Programs with Graphs, ICLR 2018<br>Are Deep Neural Networks the Best Choice for Modeling Source Code?, FSE 2017</p><h3 id="神经网络结构与算法"><a href="#神经网络结构与算法" class="headerlink" title="神经网络结构与算法"></a>神经网络结构与算法</h3><p>Neural Code Comprehension: A Learnable Representation of Code Semantics,<br>NeurIPS 2018<br>A General Path-Based Representation for Predicting Program Properties, PLDI<br>2018<br>Cross-Language Learning for Program Classification using Bilateral Tree-Based<br>Convolutional Neural Networks, AAAI 2018</p><h3 id="嵌入"><a href="#嵌入" class="headerlink" title="嵌入"></a>嵌入</h3><p>A Literature Study of Embeddings on Source Code, arxiv<br>Deep Code Search, ICSE 2018<br>Code Vectors: Understanding Programs Through Embedded Abstracted Symbolic<br>Traces, FSE 2018</p><h3 id="程序翻译"><a href="#程序翻译" class="headerlink" title="程序翻译"></a>程序翻译</h3><p>Towards Neural Decompilation, arxiv<br>Tree-to-tree Neural Networks for Program Translation, ICLR 2018<br>Code Attention: Translating Code to Comments by Exploiting Domain Features,<br>arxiv</p><h3 id="代码补全"><a href="#代码补全" class="headerlink" title="代码补全"></a>代码补全</h3><p>Aroma: Code Recommendation via Structural Code Search, arxiv</p><h3 id="程序修复"><a href="#程序修复" class="headerlink" title="程序修复"></a>程序修复</h3><p>Maximal Divergence Sequential Autoencoder for Binary Software Vulnerability<br>Detection, ICLR 2019<br>Neural Program Repair by Jointly Learning to Localize and Repair, ICLR 2019<br>Dynamic Neural Program Embedding for Program Repair, ICLR 2018</p><h3 id="模式识别"><a href="#模式识别" class="headerlink" title="模式识别"></a>模式识别</h3><p>SAR: Learning Cross-Language API Mappings with Little Knowledge, FSE 2019<br>Hierarchical Learning of Cross-Language Mappings through Distributed Vector<br>Representations for Code, ICSE 2018<br>Deep API Learning, FSE 2016</p><h3 id="代码优化"><a href="#代码优化" class="headerlink" title="代码优化"></a>代码优化</h3><p>Neural Nets Can Learn Function Type Signatures From Binaries, USENIX 2017</p><h3 id="代码总结"><a href="#代码总结" class="headerlink" title="代码总结"></a>代码总结</h3><p>Summarizing Source Code with Transferred API Knowledge, IJCAI 2018<br>A Neural Framework for Retrieval and Summarization of Source Code, ASE 2018</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;基于源代码的机器学习&quot;&gt;&lt;a href=&quot;#基于源代码的机器学习&quot; class=&quot;headerlink&quot; title=&quot;基于源代码的机器学习&quot;&gt;&lt;/a&gt;基于源代码的机器学习&lt;/h1&gt;&lt;h2 id=&quot;ML4CODE&quot;&gt;&lt;a href=&quot;#ML4CODE&quot; class</summary>
      
    
    
    
    
    <category term="Security" scheme="https://learner0x5a.github.io/tags/Security/"/>
    
    <category term="AI" scheme="https://learner0x5a.github.io/tags/AI/"/>
    
  </entry>
  
  <entry>
    <title>attention机制的理解</title>
    <link href="https://learner0x5a.github.io/2020/12/14/attention/"/>
    <id>https://learner0x5a.github.io/2020/12/14/attention/</id>
    <published>2020-12-14T11:51:22.000Z</published>
    <updated>2021-02-18T13:31:57.808Z</updated>
    
    <content type="html"><![CDATA[<h1 id="seq2seq-amp-attention"><a href="#seq2seq-amp-attention" class="headerlink" title="seq2seq &amp; attention"></a>seq2seq &amp; attention</h1><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>大多数attention都是时域attention，即关注输入序列（或者encoder的输出序列）中各个timestep的数据的不同贡献<br>那么频域attention该怎么做呢？比如要关注图像的某一部分对分类器的贡献？<br>最普通的，例如一个<code>MLP1 + Attention + MLP2</code>的结构，MLP的输出shape为(batch_size,hidden_dim)，即timestep为1，怎么算attention？<br>timestep为1的时候，softmax-&gt;sigmoid，概率分布不存在了，按原算法得到的attention是一个shape为(batch_size,1,1)的张量乘上encoder_output，相当于对每个feature乘上一个实数，意义是什么？</p><p>Update 2021-02-18: 参考<a href="https://blog.csdn.net/u010848594/article/details/107413620">这里</a>。<br>把握住attention的本质是加权，由此，<br>卷积网络里有两种attention，一种是通道attention，对各个feature map加权；一种是空间attention，利用卷积运算获得spatial attention。</p><h1 id="PyTorch-Misc"><a href="#PyTorch-Misc" class="headerlink" title="PyTorch Misc"></a>PyTorch Misc</h1><h2 id="LSTM的返回值"><a href="#LSTM的返回值" class="headerlink" title="LSTM的返回值"></a>LSTM的返回值</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">output(seq_len, batch, hidden_size * num_directions) <span class="comment"># 每个timestep，最后(深)一层的神经元输出的拼接  </span></span><br><span class="line">hn(num_layers * num_directions, batch, hidden_size) <span class="comment"># 最后一个timestep，所有神经元的输出  </span></span><br><span class="line">cn(num_layers * num_directions, batch, hidden_size) <span class="comment"># 最后一个timestep，所有神经元的细胞状态  </span></span><br></pre></td></tr></table></figure><h2 id="inplace-True"><a href="#inplace-True" class="headerlink" title="inplace=True"></a>inplace=True</h2><p>激活函数例如<code>nn.LeakyReLU(inplace=True)</code>中<code>inplace=True</code>的意思是进行原地操作，例如<code>x=x+5</code>，对于Conv2d这样的上层网络传递下来的tensor直接进行修改，好处就是可以节省运算内存。</p><h2 id="dim-1"><a href="#dim-1" class="headerlink" title="dim=-1"></a>dim=-1</h2><p><code>dim=-1</code>意为对最后一维进行操作</p><h2 id="permute-dims"><a href="#permute-dims" class="headerlink" title="permute(dims)"></a>permute(dims)</h2><p>将tensor的维度换位</p><p>permute(0,2,1) -&gt; 将后两维对换</p><h2 id="torch-cat-tensors-dim"><a href="#torch-cat-tensors-dim" class="headerlink" title="torch.cat(tensors, dim)"></a>torch.cat(tensors, dim)</h2><p>按dim拼接tensors</p><h2 id="torch-chunk-tensor-chunk-num-dim"><a href="#torch-chunk-tensor-chunk-num-dim" class="headerlink" title="torch.chunk(tensor, chunk_num, dim)"></a>torch.chunk(tensor, chunk_num, dim)</h2><p>与torch.cat()原理相反，它是将tensor按dim（行或列）分割成chunk_num个tensor块，返回的是一个元组。</p><h2 id="LSTM原理"><a href="#LSTM原理" class="headerlink" title="LSTM原理"></a>LSTM原理</h2><p><img src="/images/LSTM.png" alt="LSTM"></p><h2 id="Attention原理"><a href="#Attention原理" class="headerlink" title="Attention原理"></a>Attention<a href="https://www.zhihu.com/question/68482809/answer/264632289">原理</a></h2><p><img src="/images/attention1.jpg" alt="Attention"><br><img src="/images/attention2.jpg" alt="Attention"><br><img src="/images/attention3.jpg" alt="Attention"></p><h2 id="Attention详解"><a href="#Attention详解" class="headerlink" title="Attention详解"></a>Attention详解</h2><p>seq2seq pipeline: input vector -&gt; encoder -&gt; context vector -&gt; decoder -&gt; output vector</p><p>一般的attention<a href="https://zhuanlan.zhihu.com/p/62486641">公式</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">M = tanh(lstm_output)  </span><br><span class="line">alpha = softmax(att_weights.dot(M))  </span><br><span class="line">context_vector = lstm_output.dot(alpha.T)  </span><br></pre></td></tr></table></figure><p>att_weight 是一个(1, hidden_dim)的向量<br>对应attention本质模型，key=value=lstm_ouput，query向量在哪呢？ – 在att_weights中<br>query是学习出来的，不然attention就成了先验知识了<br>在<a href="https://blog.csdn.net/dendi_hust/article/details/94435919">这里</a>看到：把att_weight用MLP(lstm_hidden_state)代替（因为decoder的隐藏层输出和encoder的隐藏层输出处在同一个子空间内），更有道理一些，不知道效果怎么样<br>要计算query和key的相似度，可以通过內积的方式表征，更一般的，可以写作F(query,key)，怎么定义随便，F甚至可以是NN；进一步推广，将query嵌入NN中，直接NN(lstm_output)即为相似度<br>算完相似度之后，用softmax计算归一化的概率分布，再乘上value即可。<br>自注意力机制即K=V=Q，即为query=G(value) &lt;==&gt; att_weights = G(lstm_outputs), G为任意变换，比如NN</p><h2 id="Transformer"><a href="#Transformer" class="headerlink" title="Transformer"></a>Transformer</h2><p>Attention is all you need<br>提出<a href="https://zhuanlan.zhihu.com/p/44121378">Transformer</a>架构<br>encoder部分，输入数据经过Embedding之后，直接接多头自注意力层，不再先经过特征提取层例如CNN或者LSTM，然后再接一个MLP变换 +<br>残差，送入decoder</p><p>Transformer为每个输入单词的词嵌入上添加了一个新向量——位置向量，即embedding_with_time_signal =<br>positional_encoding + embedding</p><p><img src="/images/Transformer.jpg" alt="Transformer"></p><h3 id="多头attention（Multi-head-attention）"><a href="#多头attention（Multi-head-attention）" class="headerlink" title="多头attention（Multi-head attention）"></a>多头attention（Multi-head attention）</h3><p><img src="/images/Attention_Mask&Multi-head.jpg" alt="Mask&amp;Multi-head"></p><p>结构如图，Query，Key，Value首先进过一个线性变换，然后输入到放缩点积attention<br>注意这里要做h次，也就是所谓的多头，每一次算一个头，头之间参数不共享，每次Q，K，V进行线性变换的参数是不一样的。<br>然后将h次的放缩点积attention结果进行拼接，再进行一次线性变换得到的值作为多头attention的结果。<br>论文中说到这样的好处是可以允许模型在不同的表示子空间里学习到相关的信息。</p><p>代码实现上，即将Query/Key/Value都reshape一下<br>(batch_sze, timesteps, hidden_dims) -&gt; (batch_sze*num_heads, timesteps, hidden_dims/num_heads)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MultiHeadAttention</span>(<span class="params">nn.Module</span>):</span>                    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, model_dim=<span class="number">512</span>, num_heads=<span class="number">8</span>, dropout=<span class="number">0.0</span></span>):</span>  </span><br><span class="line">        <span class="built_in">super</span>(MultiHeadAttention, self).__init__()  </span><br><span class="line">    </span><br><span class="line">        self.dim_per_head = model_dim // num_heads <span class="comment"># &quot; / &quot;表示 浮点数除法，返回浮点结果;&quot; // &quot;表示整数除法  </span></span><br><span class="line">        self.num_heads = num_heads  </span><br><span class="line">        self.linear_k = nn.Linear(model_dim, self.dim_per_head * num_heads)  </span><br><span class="line">        self.linear_v = nn.Linear(model_dim, self.dim_per_head * num_heads)  </span><br><span class="line">        self.linear_q = nn.Linear(model_dim, self.dim_per_head * num_heads)  </span><br><span class="line">    </span><br><span class="line">        self.dot_product_attention = ScaledDotProductAttention(dropout)  </span><br><span class="line">        self.linear_final = nn.Linear(model_dim, model_dim)  </span><br><span class="line">        self.dropout = nn.Dropout(dropout)  </span><br><span class="line">        <span class="comment"># multi-head attention之后需要做layer norm  </span></span><br><span class="line">        self.layer_norm = nn.LayerNorm(model_dim)  </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">forward</span>(<span class="params">self, key, value, query, attn_mask=<span class="literal">None</span></span>):</span>  </span><br><span class="line">        <span class="comment"># 残差连接  </span></span><br><span class="line">        residual = query  </span><br><span class="line">    </span><br><span class="line">        dim_per_head = self.dim_per_head  </span><br><span class="line">        num_heads = self.num_heads  </span><br><span class="line">        batch_size = key.size(<span class="number">0</span>)  </span><br><span class="line">    </span><br><span class="line">        <span class="comment"># linear projection  </span></span><br><span class="line">        key = self.linear_k(key)  </span><br><span class="line">        value = self.linear_v(value)  </span><br><span class="line">        query = self.linear_q(query)  </span><br><span class="line">                      </span><br><span class="line">        <span class="comment"># split by heads  </span></span><br><span class="line">        key = key.view(batch_size * num_heads, -<span class="number">1</span>, dim_per_head)  </span><br><span class="line">        value = value.view(batch_size * num_heads, -<span class="number">1</span>, dim_per_head)  </span><br><span class="line">        query = query.view(batch_size * num_heads, -<span class="number">1</span>, dim_per_head)  </span><br><span class="line">    </span><br><span class="line">        <span class="keyword">if</span> attn_mask:  </span><br><span class="line">            attn_mask = attn_mask.repeat(num_heads, <span class="number">1</span>, <span class="number">1</span>)  </span><br><span class="line">        <span class="comment"># scaled dot product attention  </span></span><br><span class="line">        scale = (key.size(-<span class="number">1</span>) // num_heads) ** -<span class="number">0.5</span>  </span><br><span class="line">        context, attention = self.dot_product_attention(  </span><br><span class="line">            query, key, value, scale, attn_mask)  </span><br><span class="line">        <span class="comment"># concat heads  </span></span><br><span class="line">        context = context.view(batch_size, -<span class="number">1</span>, dim_per_head * num_heads)  </span><br><span class="line">    </span><br><span class="line">        <span class="comment"># final linear projection  </span></span><br><span class="line">        output = self.linear_final(context)  </span><br><span class="line">    </span><br><span class="line">        <span class="comment"># dropout  </span></span><br><span class="line">        output = self.dropout(output)  </span><br><span class="line">    </span><br><span class="line">        <span class="comment"># add residual and norm layer  </span></span><br><span class="line">        output = self.layer_norm(residual + output)  </span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> output, attention  </span><br><span class="line"></span><br></pre></td></tr></table></figure><p><a href="https://www.jianshu.com/p/e7d8caa13b21">参考</a><br><a href="https://github.com/jadore801120/attention-is-all-you-need-pytorch">Transformer Code</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;seq2seq-amp-attention&quot;&gt;&lt;a href=&quot;#seq2seq-amp-attention&quot; class=&quot;headerlink&quot; title=&quot;seq2seq &amp;amp; attention&quot;&gt;&lt;/a&gt;seq2seq &amp;amp; attenti</summary>
      
    
    
    
    
    <category term="AI" scheme="https://learner0x5a.github.io/tags/AI/"/>
    
  </entry>
  
</feed>
